<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nimrod. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module lrstgen</title>
<style type="text/css">

span.DecNumber {color: blue}
span.BinNumber {color: blue}
span.HexNumber {color: blue}
span.OctNumber {color: blue}
span.FloatNumber {color: blue}
span.Identifier  {color: black}
span.Keyword {font-weight: bold}
span.StringLit {color: blue}
span.LongStringLit {color: blue}
span.CharLit {color: blue}
span.EscapeSequence {color: black}
span.Operator {color: black}
span.Punctuation {color: black}
span.Comment, span.LongComment {font-style:italic; color: green}
span.RegularExpression  {color: DarkViolet}
span.TagStart {color: DarkViolet}
span.TagEnd {color: DarkViolet}
span.Key  {color: blue}
span.Value  {color: black}
span.RawData {color: blue}
span.Assembler  {color: blue}
span.Preprocessor {color: DarkViolet}
span.Directive  {color: DarkViolet}
span.Command, span.Rule, span.Hyperlink, span.Label, span.Reference, 
span.Other  {color: black}

div.navigation {
  -moz-border-radius: 5px 5px 5px 5px;
  float: left; 
  width: 30%;
  margin: 0; padding: 0;
  border: 3px outset #7F7F7F;
  background-color: #7F7F7F;
}

div.navigation ul {
  list-style-type: none;
  padding-left: 1em;
}
div.navigation ul li a, div.navigation ul li a:visited {
  font-weight: bold;
  color: #FFFFFF;
  text-decoration: none;
}
div.navigation ul li a:hover {
  font-weight: bold;
  text-decoration: none;
  color: gold;
}

div.content {
  margin-left: 30%;
  padding: 0 1em;
  border-left: 4em;
}

dl.item dd, dl.item dd p {
  margin-top:3px;
}
dl.item dd pre {
  margin-left: 15pt;
  border: 0px;
}
dl.item dt, dl.item dt pre {
  margin:  20pt 0 0 5pt;
}

pre, span.tok {
  background-color: #F9F9F9;
  border-color: #C4C4C4;
  border-style: solid;
  border-width: 1px 1px 1px 2px;
  color: black;
  line-spacing: 110%;
  padding: 2px;
}

span.red {
  color: #A80000;
}

hr {background-color:#9D9D9D; border:0 none; color:#9D9D9D; height:1px; width:100%;}

/*
:Author: David Goodger
:Contact: goodger@python.org
:Date: Date: 2006-05-21 22:44:42 +0200 (Sun, 21 May 2006)
:Revision: Revision: 4564
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/
/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th { border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first { margin-top: 0 ! important }
.last, .with-subtitle { margin-bottom: 0 ! important }
.hidden { display: none }
a.toc-backref { text-decoration: none ; color: black }
blockquote.epigraph { margin: 2em 5em ; }
dl.docutils dd { margin-bottom: 0.5em }
div.abstract { margin: 2em 5em }
div.abstract p.topic-title { font-weight: bold ; text-align: center }
div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ; border: medium outset ; padding: 1em }
div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title { font-weight: bold ; font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title { color: red ; font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication { margin: 2em 5em ; text-align: center ; font-style: italic }
div.dedication p.topic-title { font-weight: bold ; font-style: normal }
div.figure { margin-left: 2em ; margin-right: 2em }
div.footer, div.header { clear: both; font-size: smaller }
div.line-block { display: block ; margin-top: 1em ; margin-bottom: 1em }
div.line-block div.line-block { margin-top: 0 ; margin-bottom: 0 ;
  margin-left: 1.5em }
div.sidebar { margin-left: 1em ; border: medium outset ;
  padding: 1em ; background-color: #ffffee ; /*width: 40% ;*/ float: right ;
  clear: right }

div.sidebar p.rubric { font-family: sans-serif ; font-size: medium }
div.system-messages { margin: 5em }
div.system-messages h1 { color: red }
div.system-message { border: medium outset ; padding: 1em }
div.system-message p.system-message-title { color: red ; font-weight: bold }
div.topic { margin: 2em;}
h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }
h1.title { text-align: center }
h2.subtitle { text-align: center }
/* hr.docutils { width: 75% } */
img.align-left { clear: left }
img.align-right { clear: right }
ol.simple, ul.simple { margin-bottom: 1em }
ol.arabic { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }
p.attribution { text-align: right ; margin-left: 50% }
p.caption { font-style: italic }
p.credits { font-style: italic ; font-size: smaller }
p.label { white-space: nowrap }
p.rubric { font-weight:bold;font-size:larger;color:maroon;text-align:center}
p.sidebar-title {font-family: sans-serif ;font-weight: bold ;font-size: larger }
p.sidebar-subtitle {font-family: sans-serif ; font-weight: bold }
p.topic-title {
font-weight: bold;
background-color: #6D6D6D;
border-bottom: 1px solid #000000;
border-top: 1px solid black;
color: white;
text-align: center;
margin: 0;
}
pre.address { margin-bottom: 0;margin-top:0;font-family:serif;font-size:100% }
pre.literal-block, pre.doctest-block {margin-left: 2em ;margin-right: 2em }
span.classifier {font-family: sans-serif;font-style: oblique }
span.classifier-delimiter {font-family: sans-serif;font-weight: bold }
span.interpreted {font-family: sans-serif }
span.option {white-space: nowrap }
span.pre {white-space: pre }
span.problematic {color: red }
span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation { border-left: solid 1px gray; margin-left: 1px }
table.docinfo {margin: 2em 4em }
table.docutils {margin-top: 0.5em;margin-bottom: 0.5em; border: 0 solid #9d9d9d; border-collapse: collapse; }
table.footnote {border-left: solid 1px black;margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {padding-left: 0.5em;padding-right: 0.5em;
  vertical-align: top;}

table.docutils td, table.docutils th { border-bottom:1px solid #9D9D9D; }
/* color: #4d4d4d} */

/* table.docutils td:hover, table.docinfo td:hover {color: #000000} */
  

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold;text-align: left;white-space: nowrap;padding-left: 0 }
  
table.docutils th
{
color: black;
font-weight:normal;
background-color: #E3E3E3;
border-top: 1px solid #1d1d1d;
border-bottom: 1px solid #1d1d1d;
}
  
h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {font-size: 100% }
ul.auto-toc { list-style-type: none }
/*a.reference { color: #E00000; font-weight:bold;}
a.reference:hover {color: #E00000;background-color: #ffff00;display: margin;
  font-weight:bold;}*/

</style>

</head>
<body>
<div class="document" id="documentId">
<h1 class="title">Module lrstgen</h1>
<div class="navigation" id="navigation">
<ul class="simple">
<li>
  <a class="reference" href="#6" id="56">Imports</a>
  <ul class="simple">
    
  </ul>
</li>
<li>
  <a class="reference" href="#7" id="57">Types</a>
  <ul class="simple">
      <li><a class="reference" href="#TOutputTarget"
    title="TOutputTarget* = enum 
  outHtml, 
  outLatex"><wbr />TOutput<wbr />Target</a></li>
  <li><a class="reference" href="#TMetaEnum"
    title="TMetaEnum* = enum 
  metaNone, metaTitle, metaSubtitle, metaAuthor, metaVersion"><wbr />TMeta<wbr />Enum</a></li>
  <li><a class="reference" href="#TRstGenerator"
    title="TRstGenerator* = object of TObject
  target*: TOutputTarget
  config*: TLayeredConf
  splitAfter*: int
  tocPart*: seq[TTocEntry]
  hasToc*: bool
  theIndex: string
  findFile*: Find_file_handler
  msgHandler*: TMsgHandler
  filename*: string
  meta*: array[TMetaEnum, string]
  currentSection: string
  seenIndexTerms: TTable[string, int] ## \
                                      ## Keeps count of same text index terms to generate different identifiers
                                      ## for hyperlinks. See renderIndexTerm proc for details.
  unknownLangs*: bool         ## Set to true if unknown code block langs are found."><wbr />TRst<wbr />Generator</a></li>

  </ul>
</li>
<li>
  <a class="reference" href="#8" id="58">Vars</a>
  <ul class="simple">
      <li><a class="reference" href="#splitter"
    title="splitter*: string = &quot;&lt;wbr &#x2F;&gt;&quot;"><wbr />splitter</a></li>

  </ul>
</li>
<li>
  <a class="reference" href="#10" id="60">Consts</a>
  <ul class="simple">
      <li><a class="reference" href="#IndexExt"
    title="IndexExt* = &quot;.idx&quot;"><wbr />Index<wbr />Ext</a></li>

  </ul>
</li>
<li>
  <a class="reference" href="#12" id="62">Procs</a>
  <ul class="simple">
      <li><a class="reference" href="#default_config,"
    title="default_config*(): PStringTable"><wbr />default_<wbr />config</a></li>
  <li><a class="reference" href="#initRstGenerator,TRstGenerator,TOutputTarget,string,PStringTable,Find_file_handler,TMsgHandler"
    title="initRstGenerator*(g: var TRstGenerator; target: TOutputTarget; filename: string; 
                  user_config: PStringTable = nil; 
                  findFile: Find_file_handler = nil_find_file_handler; 
                  msgHandler: TMsgHandler = nil_msg_handler)"><wbr />init<wbr />Rst<wbr />Generator</a></li>
  <li><a class="reference" href="#writeIndexFile,TRstGenerator,string"
    title="writeIndexFile*(g: var TRstGenerator; outfile: string)"><wbr />write<wbr />Index<wbr />File</a></li>
  <li><a class="reference" href="#escChar,TOutputTarget,string,char"
    title="escChar*(target: TOutputTarget; dest: var string; c: char)"><wbr />esc<wbr />Char</a></li>
  <li><a class="reference" href="#nextSplitPoint,string,int"
    title="nextSplitPoint*(s: string; start: int): int"><wbr />next<wbr />Split<wbr />Point</a></li>
  <li><a class="reference" href="#esc,TOutputTarget,string"
    title="esc*(target: TOutputTarget; s: string; splitAfter = - 1): string"><wbr />esc</a></li>
  <li><a class="reference" href="#renderRstToOut,TRstGenerator,PRstNode,string"
    title="renderRstToOut*(d: var TRstGenerator; n: PRstNode; result: var string)"><wbr />render<wbr />Rst<wbr />To<wbr />Out</a></li>
  <li><a class="reference" href="#setIndexTerm,TRstGenerator,string,string"
    title="setIndexTerm*(d: var TRstGenerator; id, term: string; linkTitle, linkDesc = &quot;&quot;)"><wbr />set<wbr />Index<wbr />Term</a></li>
  <li><a class="reference" href="#renderIndexTerm,PDoc,PRstNode,string"
    title="renderIndexTerm*(d: PDoc; n: PRstNode; result: var string)"><wbr />render<wbr />Index<wbr />Term</a></li>
  <li><a class="reference" href="#mergeIndexes,string"
    title="mergeIndexes*(dir: string): string"><wbr />merge<wbr />Indexes</a></li>
  <li><a class="reference" href="#renderTocEntries,TRstGenerator,int,int,string"
    title="renderTocEntries*(d: var TRstGenerator; j: var int; lvl: int; result: var string)"><wbr />render<wbr />Toc<wbr />Entries</a></li>
  <li><a class="reference" href="#formatNamedVars,string,openArray[string],openArray[string]"
    title="formatNamedVars*(frmt: string; varnames: openArray[string]; 
                 varvalues: openArray[string]): string"><wbr />format<wbr />Named<wbr />Vars</a></li>
  <li><a class="reference" href="#rstToHtml,string,PStringTable"
    title="rstToHtml*(s: string; user_config: PStringTable = nil): string"><wbr />rst<wbr />To<wbr />Html</a></li>

  </ul>
</li>

</ul>
</div>
<div class="content" id="content">
<p>This module implements a generator of HTML/Latex from <span id="restructuredtext_1">reStructuredText</span> (see <a class="reference external" href="http://docutils.sourceforge.net/rst.html">http://docutils.sourceforge.net/rst.html</a> for information on this markup syntax).</p>
<p>You can generate HTML output through the convenience <a class="reference external" href="#rstToHtml">rstToHtml()</a> proc, which provided an input string with rst markup returns a string with the generated HTML. The final output is meant to be embedded inside a full document you provide yourself, so it won't contain the usual <tt class="docutils literal"><span class="pre">&lt;header&gt;</span></tt> or <tt class="docutils literal"><span class="pre">&lt;body&gt;</span></tt> parts.</p>
<p>You can also create a <tt class="docutils literal"><span class="pre">TRstGenerator</span></tt> structure and populate it with the other lower level methods to finally build complete documents. This requires many options and tweaking. <a class="reference external" href="https://en.wikipedia.org/wiki/LaTeX">LaTeX documents</a> are poorly supported.</p>

<div class="section" id="6">
<h1><a class="toc-backref" href="#56">Imports</a></h1>
<dl class="item">
<a class="reference external" href="strutils.html">strutils</a>, <a class="reference external" href="os.html">os</a>, <a class="reference external" href="hashes.html">hashes</a>, <a class="reference external" href="strtabs.html">strtabs</a>, <a class="reference external" href="lazy_rest_pkg/lrstast.html">lazy_rest_pkg/lrstast</a>, <a class="reference external" href="lazy_rest_pkg/lrst.html">lazy_rest_pkg/lrst</a>, <a class="reference external" href="lhighlite.html">lhighlite</a>, <a class="reference external" href="tables.html">tables</a>, <a class="reference external" href="sequtils.html">sequtils</a>, <a class="reference external" href="algorithm.html">algorithm</a>, <a class="reference external" href="parseutils.html">parseutils</a>, <a class="reference external" href="bb_system.html">bb_system</a>, <a class="reference external" href="lazy_rest_pkg/lconfig.html">lazy_rest_pkg/lconfig</a>, <a class="reference external" href="htmlgen.html">htmlgen</a>
</dl></div>
<div class="section" id="7">
<h1><a class="toc-backref" href="#57">Types</a></h1>
<dl class="item">
<dt id="TOutputTarget"><a name="TOutputTarget"></a><pre><span class="Identifier">TOutputTarget</span><span class="Operator">*</span> <span class="Other">=</span> <span class="Keyword">enum</span> 
  <span class="Identifier">outHtml</span><span class="Other">,</span> 
  <span class="Identifier">outLatex</span></pre></dt>
<dd>
which document type to generate

</dd>
<dt id="TMetaEnum"><a name="TMetaEnum"></a><pre><span class="Identifier">TMetaEnum</span><span class="Operator">*</span> <span class="Other">=</span> <span class="Keyword">enum</span> 
  <span class="Identifier">metaNone</span><span class="Other">,</span> <span class="Identifier">metaTitle</span><span class="Other">,</span> <span class="Identifier">metaSubtitle</span><span class="Other">,</span> <span class="Identifier">metaAuthor</span><span class="Other">,</span> <span class="Identifier">metaVersion</span></pre></dt>
<dd>


</dd>
<dt id="TRstGenerator"><a name="TRstGenerator"></a><pre><span class="Identifier">TRstGenerator</span><span class="Operator">*</span> <span class="Other">=</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">TObject</span>
  <span class="Identifier">target</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">TOutputTarget</span>
  <span class="Identifier">config</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">TLayeredConf</span>
  <span class="Identifier">splitAfter</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span>
  <span class="Identifier">tocPart</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">TTocEntry</span><span class="Other">]</span>
  <span class="Identifier">hasToc</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">bool</span>
  <span class="Identifier">theIndex</span><span class="Other">:</span> <span class="Identifier">string</span>
  <span class="Identifier">findFile</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">Find_file_handler</span>
  <span class="Identifier">msgHandler</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">TMsgHandler</span>
  <span class="Identifier">filename</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>
  <span class="Identifier">meta</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">TMetaEnum</span><span class="Other">,</span> <span class="Identifier">string</span><span class="Other">]</span>
  <span class="Identifier">currentSection</span><span class="Other">:</span> <span class="Identifier">string</span>
  <span class="Identifier">seenIndexTerms</span><span class="Other">:</span> <span class="Identifier">TTable</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span> <span class="Comment">## \</span>
                                      <span class="Comment">## Keeps count of same text index terms to generate different identifiers</span>
                                      <span class="Comment">## for hyperlinks. See renderIndexTerm proc for details.</span>
  <span class="Identifier">unknownLangs</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">bool</span>         <span class="Comment">## Set to true if unknown code block langs are found.</span>
  </pre></dt>
<dd>

Stores the empty string or the last headline/overline found in the rst document, so it can be used as a prettier name for term index generation.

</dd>

</dl></div>
<div class="section" id="8">
<h1><a class="toc-backref" href="#58">Vars</a></h1>
<dl class="item">
<dt id="splitter"><a name="splitter"></a><pre><span class="Identifier">splitter</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Other">=</span> <span class="StringLit">&quot;&lt;wbr /&gt;&quot;</span></pre></dt>
<dd>


</dd>

</dl></div>
<div class="section" id="10">
<h1><a class="toc-backref" href="#60">Consts</a></h1>
<dl class="item">
<dt id="IndexExt"><a name="IndexExt"></a><pre><span class="Identifier">IndexExt</span><span class="Operator">*</span> <span class="Other">=</span> <span class="StringLit">&quot;.idx&quot;</span></pre></dt>
<dd>


</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#62">Procs</a></h1>
<dl class="item">
<dt id="default_config"><a name="default_config,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">default_config</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">PStringTable</span></pre></dt>
<dd>
<p>Returns a default configuration for stand alone file HTML generation.</p>
<p>The returned <tt class="docutils literal"><span class="pre">PStringTable</span></tt> contains the paramters used by the HTML engine to build the final output. The default parameters come from the embedded file <a class="reference external" href="https://github.com/gradha/lazy_rest/blob/master/resources/embedded_nimdoc.cfg">resources/embedded_nimdoc.cfg</a>.</p>


</dd>
<dt id="initRstGenerator"><a name="initRstGenerator,TRstGenerator,TOutputTarget,string,PStringTable,Find_file_handler,TMsgHandler"></a><pre><span class="Keyword">proc</span> <span class="Identifier">initRstGenerator</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">g</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">TRstGenerator</span><span class="Other">;</span> <span class="Identifier">target</span><span class="Other">:</span> <span class="Identifier">TOutputTarget</span><span class="Other">;</span> 
                       <span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">user_config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">;</span> 
                       <span class="Identifier">findFile</span><span class="Other">:</span> <span class="Identifier">Find_file_handler</span> <span class="Other">=</span> <span class="Identifier">nil_find_file_handler</span><span class="Other">;</span> 
                       <span class="Identifier">msgHandler</span><span class="Other">:</span> <span class="Identifier">TMsgHandler</span> <span class="Other">=</span> <span class="Identifier">nil_msg_handler</span><span class="Other">)</span></pre></dt>
<dd>
<p>Initializes a <tt class="docutils literal"><span class="pre">TRstGenerator</span></tt>.</p>
<p>You need to call this before using a <tt class="docutils literal"><span class="pre">TRstGenerator</span></tt> with any other procs in this module. You can pass a non <tt class="docutils literal"><span class="pre">nil</span></tt> <tt class="docutils literal"><span class="pre">PStringTable</span></tt> value as <cite>user_config</cite> to override the default embedded parameters, which are extracted internally from the <a class="reference external" href="#default_config">default_config()</a> proc.</p>
<p>The <cite>filename</cite> parameter will be used for error reporting and creating index hyperlinks to the file, but you can pass an empty string here if you are parsing a stream in memory. If <cite>filename</cite> ends with the <tt class="docutils literal"><span class="pre">.nim</span></tt> extension, the title for the document will be set by default to <tt class="docutils literal"><span class="pre">Module filename</span></tt>.  This default title can be overriden by the embedded rst, but it helps to prettify the generated index if no title is found.</p>
<p>The <tt class="docutils literal"><span class="pre">TFindFileHandler</span></tt> and <tt class="docutils literal"><span class="pre">TMsgHandler</span></tt> types are defined in the the <a class="reference external" href="lrst.html">lrst module</a>.</p>
<p><tt class="docutils literal"><span class="pre">findFile</span></tt> is a proc used by the rst <tt class="docutils literal"><span class="pre">include</span></tt> directive among others. The purpose of this proc is to mangle or filter paths. It receives paths specified in the rst document and has to return a valid path to existing files or the empty string otherwise.  If you pass <tt class="docutils literal"><span class="pre">nil</span></tt>, a default proc will be used which given a path returns the input path only if the file exists. One use for this proc is to transform relative paths found in the document to absolute path, useful if the rst file and the resources it references are not in the same directory as the current working directory.</p>
<p>The <tt class="docutils literal"><span class="pre">msgHandler</span></tt> is a proc used for user error reporting. It will be called with the filename, line, col, and type of any error found during parsing. If you pass <tt class="docutils literal"><span class="pre">nil</span></tt>, a default message handler will be used which silently discards all messages.</p>
<p>Example:</p>
<pre><span class="Keyword">import</span> <span class="Identifier">packages</span><span class="Operator">/</span><span class="Identifier">docutils</span><span class="Operator">/</span><span class="Identifier">rstgen</span>

<span class="Keyword">var</span> <span class="Identifier">gen</span><span class="Punctuation">:</span> <span class="Identifier">TRstGenerator</span>

<span class="Identifier">gen</span><span class="Operator">.</span><span class="Identifier">initRstGenerator</span><span class="Punctuation">(</span><span class="Identifier">outHtml</span><span class="Punctuation">,</span> <span class="Identifier">default_config</span><span class="Punctuation">(</span><span class="Punctuation">)</span><span class="Punctuation">,</span>
  <span class="StringLit">&quot;filename&quot;</span><span class="Punctuation">,</span> <span class="Punctuation">{</span><span class="Punctuation">}</span><span class="Punctuation">,</span> <span class="Keyword">nil</span><span class="Punctuation">,</span> <span class="Keyword">nil</span><span class="Punctuation">)</span></pre>

</dd>
<dt id="writeIndexFile"><a name="writeIndexFile,TRstGenerator,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">writeIndexFile</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">g</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">TRstGenerator</span><span class="Other">;</span> <span class="Identifier">outfile</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span></pre></dt>
<dd>
<p>Writes the current index buffer to the specified output file.</p>
<p>You previously need to add entries to the index with the <a class="reference external" href="#setIndexTerm">setIndexTerm()</a> proc. If the index is empty the file won't be created.</p>


</dd>
<dt id="escChar"><a name="escChar,TOutputTarget,string,char"></a><pre><span class="Keyword">proc</span> <span class="Identifier">escChar</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">target</span><span class="Other">:</span> <span class="Identifier">TOutputTarget</span><span class="Other">;</span> <span class="Identifier">dest</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">c</span><span class="Other">:</span> <span class="Identifier">char</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">inline</span><span class="Other">.}</span></pre></dt>
<dd>


</dd>
<dt id="nextSplitPoint"><a name="nextSplitPoint,string,int"></a><pre><span class="Keyword">proc</span> <span class="Identifier">nextSplitPoint</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">start</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
<dd>


</dd>
<dt id="esc"><a name="esc,TOutputTarget,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">esc</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">target</span><span class="Other">:</span> <span class="Identifier">TOutputTarget</span><span class="Other">;</span> <span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">splitAfter</span> <span class="Other">=</span> <span class="Operator">-</span> <span class="DecNumber">1</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span></pre></dt>
<dd>


</dd>
<dt id="renderRstToOut"><a name="renderRstToOut,TRstGenerator,PRstNode,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">renderRstToOut</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">TRstGenerator</span><span class="Other">;</span> <span class="Identifier">n</span><span class="Other">:</span> <span class="Identifier">PRstNode</span><span class="Other">;</span> <span class="Identifier">result</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">string</span><span class="Other">)</span></pre></dt>
<dd>
<p>Writes into <tt class="docutils literal"><span class="pre">result</span></tt> the rst ast <tt class="docutils literal"><span class="pre">n</span></tt> using the <tt class="docutils literal"><span class="pre">d</span></tt> configuration.</p>
<p>Before using this proc you need to initialise a <tt class="docutils literal"><span class="pre">TRstGenerator</span></tt> with <a class="reference external" href="#initRstGenerator">initRstGenerator</a> and parse a rst file with <tt class="docutils literal"><span class="pre">rstParse</span></tt> from the <a class="reference external" href="lrst.html">lrst module</a>. Example:</p>
<pre><span class="Comment"># ...configure gen and rst vars...</span>
<span class="Keyword">var</span> <span class="Identifier">generatedHTML</span> <span class="Operator">=</span> <span class="StringLit">&quot;&quot;</span>
<span class="Identifier">renderRstToOut</span><span class="Punctuation">(</span><span class="Identifier">gen</span><span class="Punctuation">,</span> <span class="Identifier">rst</span><span class="Punctuation">,</span> <span class="Identifier">generatedHTML</span><span class="Punctuation">)</span>
<span class="Identifier">echo</span> <span class="Identifier">generatedHTML</span></pre>

</dd>
<dt id="setIndexTerm"><a name="setIndexTerm,TRstGenerator,string,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">setIndexTerm</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">TRstGenerator</span><span class="Other">;</span> <span class="Identifier">id</span><span class="Other">,</span> <span class="Identifier">term</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> 
                   <span class="Identifier">linkTitle</span><span class="Other">,</span> <span class="Identifier">linkDesc</span> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">)</span></pre></dt>
<dd>
<p>Adds a <cite>term</cite> to the index using the specified hyperlink identifier.</p>
<p>A new entry will be added to the index using the format <tt class="docutils literal"><span class="pre">term&lt;tab&gt;file#id</span></tt>. The file part will come from the <cite>filename</cite> parameter used in a previous call to the <a class="reference external" href="#initRstGenerator">initRstGenerator()</a> proc.</p>
<p>The <cite>id</cite> will be appended with a hash character only if its length is not zero, otherwise no specific anchor will be generated. In general you should only pass an empty <cite>id</cite> value for the title of standalone rst documents (they are special for the <a class="reference external" href="#mergeIndexes">mergeIndexes()</a> proc, see <a class="reference external" href="http://build.nimrod-lang.org/docs/docgen.html#index-idx-file-format">Index (idx) file format</a> for more information). Unlike other index terms, title entries are inserted at the beginning of the accumulated buffer to maintain a logical order of entries.</p>
<p>If <cite>linkTitle</cite> or <cite>linkDesc</cite> are not the empty string, two additional columns with their contents will be added.</p>
<p>The index won't be written to disk unless you call <a class="reference external" href="#writeIndexFile">writeIndexFile()</a>. The purpose of the index is documented in the <a class="reference external" href="http://build.nimrod-lang.org/docs/docgen.html#index-switch">docgen tools guide</a>.</p>


</dd>
<dt id="renderIndexTerm"><a name="renderIndexTerm,PDoc,PRstNode,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">renderIndexTerm</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <span class="Identifier">PDoc</span><span class="Other">;</span> <span class="Identifier">n</span><span class="Other">:</span> <span class="Identifier">PRstNode</span><span class="Other">;</span> <span class="Identifier">result</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">string</span><span class="Other">)</span></pre></dt>
<dd>
<p>Renders the string decorated within `foobar`:idx: markers.</p>
<p>Additionally adds the encosed text to the index as a term. Since we are interested in different instances of the same term to have different entries, a table is used to keep track of the amount of times a term has previously appeared to give a different identifier value for each.</p>


</dd>
<dt id="mergeIndexes"><a name="mergeIndexes,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">mergeIndexes</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">dir</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span></pre></dt>
<dd>
<p>Merges all index files in <cite>dir</cite> and returns the generated index as HTML.</p>
<p>This proc will first scan <cite>dir</cite> for index files with the <tt class="docutils literal"><span class="pre">.idx</span></tt> extension previously created by commands like <tt class="docutils literal"><span class="pre">nimrod doc|rst2html</span></tt> which use the <tt class="docutils literal"><span class="pre">--index:on</span></tt> switch. These index files are the result of calls to <a class="reference external" href="#setIndexTerm">setIndexTerm()</a> and <a class="reference external" href="#writeIndexFile">writeIndexFile()</a>, so they are simple tab separated files.</p>
<p>As convention this proc will split index files into two categories: documentation and API. API indices will be all joined together into a single big sorted index, making the bulk of the final index. This is good for API documentation because many symbols are repated in different modules. On the other hand, documentation indices are essentially table of contents plus a few special markers. These documents will be rendered in a separate section which tries to maintain the order and hierarchy of the symbols in the index file.</p>
<p>To differentiate between a documentation and API file a convention is used: indices which contain one entry without the HTML hash character (#) will be considered <cite>documentation</cite>, since this hash-less entry is the explicit title of the document.  Indices without this explicit entry will be considered <cite>generated API</cite> extracted out of a source <tt class="docutils literal"><span class="pre">.nim</span></tt> file.</p>
<p>Returns the merged and sorted indices into a single HTML block which can be further embedded into nimdoc templates.</p>


</dd>
<dt id="renderTocEntries"><a name="renderTocEntries,TRstGenerator,int,int,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">renderTocEntries</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">TRstGenerator</span><span class="Other">;</span> <span class="Identifier">j</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">lvl</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span> 
                       <span class="Identifier">result</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">string</span><span class="Other">)</span></pre></dt>
<dd>


</dd>
<dt id="formatNamedVars"><a name="formatNamedVars,string,openArray[string],openArray[string]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">formatNamedVars</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">frmt</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">varnames</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">;</span> 
                      <span class="Identifier">varvalues</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span></pre></dt>
<dd>


</dd>
<dt id="rstToHtml"><a name="rstToHtml,string,PStringTable"></a><pre><span class="Keyword">proc</span> <span class="Identifier">rstToHtml</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">user_config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span></pre></dt>
<dd>
<p>Converts an input rst string into embeddable HTML.</p>
<p>This convenience proc parses any input string using rst markup (it doesn't have to be a full document!) and returns an embeddable piece of HTML. The proc is meant to be used in <em>online</em> environments without access to a meaningful filesystem, and therefore rst <tt class="docutils literal"><span class="pre">include</span></tt> like directives won't work. For an explanation of the <cite>user_config</cite> parameter see the <a class="reference external" href="#initRstGenerator">initRstGenerator</a> proc. Example:</p>
<pre><span class="Keyword">import</span> <span class="Identifier">packages</span><span class="Operator">/</span><span class="Identifier">docutils</span><span class="Operator">/</span><span class="Identifier">rstgen</span><span class="Punctuation">,</span> <span class="Identifier">strtabs</span>

<span class="Identifier">echo</span> <span class="Identifier">rstToHtml</span><span class="Punctuation">(</span><span class="StringLit">&quot;*Hello* **world**!&quot;</span><span class="Punctuation">,</span> <span class="Punctuation">{</span><span class="Punctuation">}</span><span class="Punctuation">)</span>
<span class="Comment"># --&gt; &lt;em&gt;Hello&lt;/em&gt; &lt;strong&gt;world&lt;/strong&gt;!</span></pre><p>If you need to allow the rst <tt class="docutils literal"><span class="pre">include</span></tt> directive or tweak the generated output you have to create your own <tt class="docutils literal"><span class="pre">TRstGenerator</span></tt> with <a class="reference external" href="#initRstGenerator">initRstGenerator</a> and related procs.</p>


</dd>

</dl></div>

</div>

<small>Generated: 2015-01-13 02:03:25 UTC</small>
</div>
</body>
</html>
