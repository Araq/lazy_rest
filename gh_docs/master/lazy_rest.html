<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nimrod. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module lazy_rest</title>
<style type="text/css">

span.DecNumber {color: blue}
span.BinNumber {color: blue}
span.HexNumber {color: blue}
span.OctNumber {color: blue}
span.FloatNumber {color: blue}
span.Identifier  {color: black}
span.Keyword {font-weight: bold}
span.StringLit {color: blue}
span.LongStringLit {color: blue}
span.CharLit {color: blue}
span.EscapeSequence {color: black}
span.Operator {color: black}
span.Punctuation {color: black}
span.Comment, span.LongComment {font-style:italic; color: green}
span.RegularExpression  {color: DarkViolet}
span.TagStart {color: DarkViolet}
span.TagEnd {color: DarkViolet}
span.Key  {color: blue}
span.Value  {color: black}
span.RawData {color: blue}
span.Assembler  {color: blue}
span.Preprocessor {color: DarkViolet}
span.Directive  {color: DarkViolet}
span.Command, span.Rule, span.Hyperlink, span.Label, span.Reference, 
span.Other  {color: black}

div.navigation {
  -moz-border-radius: 5px 5px 5px 5px;
  float: left; 
  width: 30%;
  margin: 0; padding: 0;
  border: 3px outset #7F7F7F;
  background-color: #7F7F7F;
}

div.navigation ul {
  list-style-type: none;
  padding-left: 1em;
}
div.navigation ul li a, div.navigation ul li a:visited {
  font-weight: bold;
  color: #FFFFFF;
  text-decoration: none;
}
div.navigation ul li a:hover {
  font-weight: bold;
  text-decoration: none;
  color: gold;
}

div.content {
  margin-left: 30%;
  padding: 0 1em;
  border-left: 4em;
}

dl.item dd, dl.item dd p {
  margin-top:3px;
}
dl.item dd pre {
  margin-left: 15pt;
  border: 0px;
}
dl.item dt, dl.item dt pre {
  margin:  20pt 0 0 5pt;
}

pre, span.tok {
  background-color: #F9F9F9;
  border-color: #C4C4C4;
  border-style: solid;
  border-width: 1px 1px 1px 2px;
  color: black;
  line-spacing: 110%;
  padding: 2px;
}

span.red {
  color: #A80000;
}

hr {background-color:#9D9D9D; border:0 none; color:#9D9D9D; height:1px; width:100%;}

/*
:Author: David Goodger
:Contact: goodger@python.org
:Date: Date: 2006-05-21 22:44:42 +0200 (Sun, 21 May 2006)
:Revision: Revision: 4564
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/
/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th { border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first { margin-top: 0 ! important }
.last, .with-subtitle { margin-bottom: 0 ! important }
.hidden { display: none }
a.toc-backref { text-decoration: none ; color: black }
blockquote.epigraph { margin: 2em 5em ; }
dl.docutils dd { margin-bottom: 0.5em }
div.abstract { margin: 2em 5em }
div.abstract p.topic-title { font-weight: bold ; text-align: center }
div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ; border: medium outset ; padding: 1em }
div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title { font-weight: bold ; font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title { color: red ; font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication { margin: 2em 5em ; text-align: center ; font-style: italic }
div.dedication p.topic-title { font-weight: bold ; font-style: normal }
div.figure { margin-left: 2em ; margin-right: 2em }
div.footer, div.header { clear: both; font-size: smaller }
div.line-block { display: block ; margin-top: 1em ; margin-bottom: 1em }
div.line-block div.line-block { margin-top: 0 ; margin-bottom: 0 ;
  margin-left: 1.5em }
div.sidebar { margin-left: 1em ; border: medium outset ;
  padding: 1em ; background-color: #ffffee ; /*width: 40% ;*/ float: right ;
  clear: right }

div.sidebar p.rubric { font-family: sans-serif ; font-size: medium }
div.system-messages { margin: 5em }
div.system-messages h1 { color: red }
div.system-message { border: medium outset ; padding: 1em }
div.system-message p.system-message-title { color: red ; font-weight: bold }
div.topic { margin: 2em;}
h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }
h1.title { text-align: center }
h2.subtitle { text-align: center }
/* hr.docutils { width: 75% } */
img.align-left { clear: left }
img.align-right { clear: right }
ol.simple, ul.simple { margin-bottom: 1em }
ol.arabic { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }
p.attribution { text-align: right ; margin-left: 50% }
p.caption { font-style: italic }
p.credits { font-style: italic ; font-size: smaller }
p.label { white-space: nowrap }
p.rubric { font-weight:bold;font-size:larger;color:maroon;text-align:center}
p.sidebar-title {font-family: sans-serif ;font-weight: bold ;font-size: larger }
p.sidebar-subtitle {font-family: sans-serif ; font-weight: bold }
p.topic-title {
font-weight: bold;
background-color: #6D6D6D;
border-bottom: 1px solid #000000;
border-top: 1px solid black;
color: white;
text-align: center;
margin: 0;
}
pre.address { margin-bottom: 0;margin-top:0;font-family:serif;font-size:100% }
pre.literal-block, pre.doctest-block {margin-left: 2em ;margin-right: 2em }
span.classifier {font-family: sans-serif;font-style: oblique }
span.classifier-delimiter {font-family: sans-serif;font-weight: bold }
span.interpreted {font-family: sans-serif }
span.option {white-space: nowrap }
span.pre {white-space: pre }
span.problematic {color: red }
span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation { border-left: solid 1px gray; margin-left: 1px }
table.docinfo {margin: 2em 4em }
table.docutils {margin-top: 0.5em;margin-bottom: 0.5em; border: 0 solid #9d9d9d; border-collapse: collapse; }
table.footnote {border-left: solid 1px black;margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {padding-left: 0.5em;padding-right: 0.5em;
  vertical-align: top;}

table.docutils td, table.docutils th { border-bottom:1px solid #9D9D9D; }
/* color: #4d4d4d} */

/* table.docutils td:hover, table.docinfo td:hover {color: #000000} */
  

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold;text-align: left;white-space: nowrap;padding-left: 0 }
  
table.docutils th
{
color: black;
font-weight:normal;
background-color: #E3E3E3;
border-top: 1px solid #1d1d1d;
border-bottom: 1px solid #1d1d1d;
}
  
h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {font-size: 100% }
ul.auto-toc { list-style-type: none }
/*a.reference { color: #E00000; font-weight:bold;}
a.reference:hover {color: #E00000;background-color: #ffff00;display: margin;
  font-weight:bold;}*/

</style>

</head>
<body>
<div class="document" id="documentId">
<h1 class="title">Module lazy_rest</h1>
<div class="navigation" id="navigation">
<ul class="simple">
<li>
  <a class="reference" href="#6" id="56">Imports</a>
  <ul class="simple">
    
  </ul>
</li>
<li>
  <a class="reference" href="#10" id="60">Consts</a>
  <ul class="simple">
      <li><a class="reference" href="#version_int"
    title="version_int* = (major: 0, minor: 1, maintenance: 0)"><wbr />version_<wbr />int</a></li>
  <li><a class="reference" href="#version_str"
    title="version_str* = tuple_to_version(version_int)"><wbr />version_<wbr />str</a></li>

  </ul>
</li>
<li>
  <a class="reference" href="#12" id="62">Procs</a>
  <ul class="simple">
      <li><a class="reference" href="#stdout_msg_handler,string,int,int,TMsgKind,string"
    title="stdout_msg_handler*(filename: string; line, col: int; msgkind: TMsgKind; 
                    arg: string): string"><wbr />stdout_<wbr />msg_<wbr />handler</a></li>
  <li><a class="reference" href="#unrestricted_find_file_handler,string,string"
    title="unrestricted_find_file_handler*(current_filename, target_filename: string): string"><wbr />unrestricted_<wbr />find_<wbr />file_<wbr />handler</a></li>
  <li><a class="reference" href="#parse_rst_options,string"
    title="parse_rst_options*(options: string): PStringTable"><wbr />parse_<wbr />rst_<wbr />options</a></li>
  <li><a class="reference" href="#rst_string_to_html,string,string,PStringTable,Find_file_handler,TMsgHandler"
    title="rst_string_to_html*(content, filename: string; user_config: PStringTable = nil; 
    find_file: Find_file_handler = unrestricted_find_file_handler; 
                    msg_handler: TMsgHandler = stdout_msg_handler): string"><wbr />rst_<wbr />string_<wbr />to_<wbr />html</a></li>
  <li><a class="reference" href="#rst_file_to_html,string,PStringTable,Find_file_handler,TMsgHandler"
    title="rst_file_to_html*(filename: string; user_config: PStringTable = nil; find_file: Find_file_handler = unrestricted_find_file_handler; 
                  msg_handler: TMsgHandler = stdout_msg_handler): string"><wbr />rst_<wbr />file_<wbr />to_<wbr />html</a></li>
  <li><a class="reference" href="#safe_rst_string_to_html,string,string,ptr.seq[string],PStringTable,Find_file_handler,TMsgHandler"
    title="safe_rst_string_to_html*(filename, data: string; ERRORS: ptr seq[string] = nil; 
                         user_config: PStringTable = nil; find_file: Find_file_handler = unrestricted_find_file_handler; 
                         msg_handler: TMsgHandler = stdout_msg_handler): string"><wbr />safe_<wbr />rst_<wbr />string_<wbr />to_<wbr />html</a></li>
  <li><a class="reference" href="#safe_rst_file_to_html,string,ptr.seq[string],PStringTable,Find_file_handler,TMsgHandler"
    title="safe_rst_file_to_html*(filename: string; ERRORS: ptr seq[string] = nil; 
                       user_config: PStringTable = nil; find_file: Find_file_handler = unrestricted_find_file_handler; 
                       msg_handler: TMsgHandler = stdout_msg_handler): string"><wbr />safe_<wbr />rst_<wbr />file_<wbr />to_<wbr />html</a></li>
  <li><a class="reference" href="#nim_file_to_html,string,PStringTable"
    title="nim_file_to_html*(filename: string; number_lines = true; 
                  user_config: PStringTable = nil): string"><wbr />nim_<wbr />file_<wbr />to_<wbr />html</a></li>
  <li><a class="reference" href="#set_normal_error_rst,string"
    title="set_normal_error_rst*(input_rst: string): seq[string]"><wbr />set_<wbr />normal_<wbr />error_<wbr />rst</a></li>
  <li><a class="reference" href="#set_safe_error_rst,string"
    title="set_safe_error_rst*(input_rst: string): seq[string]"><wbr />set_<wbr />safe_<wbr />error_<wbr />rst</a></li>

  </ul>
</li>

</ul>
</div>
<div class="content" id="content">
<p>Main API of <a class="reference external" href="https://github.com/gradha/lazy_rest">lazy_rest</a> a reStructuredText processing module for Nimrod.</p>
<p>For more information regarding Nimrod usage see the <a class="reference external" href="docs/nimrod_usage.rst">Nimrod usage guide</a>.</p>
<p>If you are looking for the C API documentation, go to the <a class="reference external" href="lazy_rest_c_api.html">lazy_rest_c_api.nim</a> file.</p>

<div class="section" id="6">
<h1><a class="toc-backref" href="#56">Imports</a></h1>
<dl class="item">
<a class="reference external" href="lazy_rest_pkg/lrstgen.html">lazy_rest_pkg/lrstgen</a>, <a class="reference external" href="os.html">os</a>, <a class="reference external" href="lazy_rest_pkg/lrst.html">lazy_rest_pkg/lrst</a>, <a class="reference external" href="strutils.html">strutils</a>, <a class="reference external" href="parsecfg.html">parsecfg</a>, <a class="reference external" href="subexes.html">subexes</a>, <a class="reference external" href="strtabs.html">strtabs</a>, <a class="reference external" href="streams.html">streams</a>, <a class="reference external" href="times.html">times</a>, <a class="reference external" href="cgi.html">cgi</a>, <a class="reference external" href="logging.html">logging</a>, <a class="reference external" href="external/badger_bits/bb_system.html">external/badger_bits/bb_system</a>, <a class="reference external" href="lazy_rest_pkg/lconfig.html">lazy_rest_pkg/lconfig</a>
</dl></div>
<div class="section" id="10">
<h1><a class="toc-backref" href="#60">Consts</a></h1>
<dl class="item">
<dt id="version_int"><a name="version_int"></a><pre><span class="Identifier">version_int</span><span class="Operator">*</span> <span class="Other">=</span> <span class="Other">(</span><span class="Identifier">major</span><span class="Other">:</span> <span class="DecNumber">0</span><span class="Other">,</span> <span class="Identifier">minor</span><span class="Other">:</span> <span class="DecNumber">1</span><span class="Other">,</span> <span class="Identifier">maintenance</span><span class="Other">:</span> <span class="DecNumber">0</span><span class="Other">)</span></pre></dt>
<dd>
<p>
Module version as an integer tuple.</p>
<p>Major versions changes mean a break in API backwards compatibility, either through removal of symbols or modification of their purpose.</p>
<p>Minor version changes can add procs (and maybe default parameters). Minor odd versions are development/git/unstable versions. Minor even versions are public stable releases.</p>
<p>Maintenance version changes mean I'm not perfect yet despite all the kpop I watch.</p>


</dd>
<dt id="version_str"><a name="version_str"></a><pre><span class="Identifier">version_str</span><span class="Operator">*</span> <span class="Other">=</span> <span class="Identifier">tuple_to_version</span><span class="Other">(</span><span class="Identifier">version_int</span><span class="Other">)</span></pre></dt>
<dd>

Module version as a string. Something like <tt class="docutils literal"><span class="pre">1.9.2</span></tt>.

</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#62">Procs</a></h1>
<dl class="item">
<dt id="stdout_msg_handler"><a name="stdout_msg_handler,string,int,int,TMsgKind,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">stdout_msg_handler</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">line</span><span class="Other">,</span> <span class="Identifier">col</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">msgkind</span><span class="Other">:</span> <span class="Identifier">TMsgKind</span><span class="Other">;</span> 
                         <span class="Identifier">arg</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Other">{.</span><span class="Identifier">procvar</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> 
    <span class="Identifier">exportc</span><span class="Other">:</span> <span class="StringLit">&quot;lr_stdout_msg_handler&quot;</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Default handler to report warnings/errors.</p>
<p>This implementation shows the warning or error through <tt class="docutils literal"><span class="pre">stdout</span></tt>. In the case of error the message is returned so that the <tt class="docutils literal"><span class="pre">EParseError</span></tt> exception can be raised to avoid continuing. This procvar conforms to the <a class="reference external" href="lazy_rest_pkg/lrst.html#TMsgHandler">TMsgHandler type specification</a>.</p>


</dd>
<dt id="unrestricted_find_file_handler"><a name="unrestricted_find_file_handler,string,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">unrestricted_find_file_handler</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">current_filename</span><span class="Other">,</span> <span class="Identifier">target_filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Other">{.</span>
    <span class="Identifier">procvar</span><span class="Other">,</span> <span class="Identifier">exportc</span><span class="Other">:</span> <span class="StringLit">&quot;lr_unrestricted_find_file_handler&quot;</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Default handler to resolve file path navigation.</p>
<p>This proc is called according to the <a class="reference external" href="lazy_rest_pkg/lrst.html#Find_file_handler">Find_file_handler type specification</a>. The includes are always resolved, hence the <em>unrestricted</em>. You might want to provide your own security aware version which restricts absolute paths. Or disable file access altogether passing the <a class="reference external" href="lazy_rest_pkg/lrst.html#nil_find_file_handler">lrst.nil_find_file_handler()</a> proc where appropriate. Example:</p>
<pre><span class="Keyword">if</span> <span class="Identifier">trusted_source</span><span class="Punctuation">:</span>
  <span class="Identifier">buf</span> <span class="Operator">=</span> <span class="Identifier">safe_rst_file_to_html</span><span class="Punctuation">(</span><span class="Identifier">filename</span><span class="Punctuation">,</span>
    <span class="Identifier">find_file</span> <span class="Operator">=</span> <span class="Identifier">unrestricted_find_file_handler</span><span class="Punctuation">)</span>
<span class="Keyword">else</span><span class="Punctuation">:</span>
  <span class="Identifier">buf</span> <span class="Operator">=</span> <span class="Identifier">safe_rst_file_to_html</span><span class="Punctuation">(</span><span class="Identifier">filename</span><span class="Punctuation">,</span>
    <span class="Identifier">find_file</span> <span class="Operator">=</span> <span class="Identifier">nil_find_file_handler</span><span class="Punctuation">)</span></pre>

</dd>
<dt id="parse_rst_options"><a name="parse_rst_options,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">parse_rst_options</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">options</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">PStringTable</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Parses the options, returns nil if something goes wrong.</p>
<p>You can safely pass the result of this proc to <a class="reference external" href="#rst_string_to_html">rst_string_to_html()</a> or any other proc asking for configuration options since they will handle nil gracefully.</p>


</dd>
<dt id="rst_string_to_html"><a name="rst_string_to_html,string,string,PStringTable,Find_file_handler,TMsgHandler"></a><pre><span class="Keyword">proc</span> <span class="Identifier">rst_string_to_html</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">content</span><span class="Other">,</span> <span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> 
                         <span class="Identifier">user_config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">;</span> <span class="Identifier">find_file</span><span class="Other">:</span> <span class="Identifier">Find_file_handler</span> <span class="Other">=</span> <span class="Identifier">unrestricted_find_file_handler</span><span class="Other">;</span> 
                         <span class="Identifier">msg_handler</span><span class="Other">:</span> <span class="Identifier">TMsgHandler</span> <span class="Other">=</span> <span class="Identifier">stdout_msg_handler</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span></pre></dt>
<dd>
<p>Converts a content named filename into a string with HTML tags.</p>
<p>If there is any problem with the parsing, an exception could be thrown.</p>
<p>You can pass nil as <cite>user_config</cite> if you want to use the default HTML rendering templates embedded in the module. Or you can load a configuration file with <a class="reference external" href="#parse_rst_options">parse_rst_options</a> or <a class="reference external" href="#load_config">load_config</a>.  The value for the <cite>user_config</cite> parameter is explained in <a class="reference external" href="lazy_rest_pkg/lrstgen.html#initRstGenerator">lazy_rest/lrstgen.initRstGenerator()</a>.</p>
<p>By default the <cite>find_file</cite> parameter will be the <a class="reference external" href="#unrestricted_find_file_handler">unrestricted_find_file_handler()</a> proc. If you pass <tt class="docutils literal"><span class="pre">nil</span></tt> the <a class="reference external" href="lazy_rest_pkg/lrst.html#nil_find_file_handler">lrst.nil_find_file_handler()</a> proc will be used instead.</p>


</dd>
<dt id="rst_file_to_html"><a name="rst_file_to_html,string,PStringTable,Find_file_handler,TMsgHandler"></a><pre><span class="Keyword">proc</span> <span class="Identifier">rst_file_to_html</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">user_config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">;</span> 
    <span class="Identifier">find_file</span><span class="Other">:</span> <span class="Identifier">Find_file_handler</span> <span class="Other">=</span> <span class="Identifier">unrestricted_find_file_handler</span><span class="Other">;</span> 
                       <span class="Identifier">msg_handler</span><span class="Other">:</span> <span class="Identifier">TMsgHandler</span> <span class="Other">=</span> <span class="Identifier">stdout_msg_handler</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span></pre></dt>
<dd>
<p>Converts a filename with rest content into a string with HTML tags.</p>
<p>If there is any problem with the parsing, an exception could be thrown.</p>
<p>By default the <cite>find_file</cite> parameter will be the <a class="reference external" href="#unrestricted_find_file_handler">unrestricted_find_file_handler()</a> proc. If you pass <tt class="docutils literal"><span class="pre">nil</span></tt> the <a class="reference external" href="lazy_rest_pkg/lrst.html#nil_find_file_handler">lrst.nil_find_file_handler()</a> proc will be used instead.</p>


</dd>
<dt id="safe_rst_string_to_html"><a name="safe_rst_string_to_html,string,string,ptr.seq[string],PStringTable,Find_file_handler,TMsgHandler"></a><pre><span class="Keyword">proc</span> <span class="Identifier">safe_rst_string_to_html</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">filename</span><span class="Other">,</span> <span class="Identifier">data</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> 
                              <span class="Identifier">ERRORS</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">;</span> 
                              <span class="Identifier">user_config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">;</span> <span class="Identifier">find_file</span><span class="Other">:</span> <span class="Identifier">Find_file_handler</span> <span class="Other">=</span> <span class="Identifier">unrestricted_find_file_handler</span><span class="Other">;</span> 
                              <span class="Identifier">msg_handler</span><span class="Other">:</span> <span class="Identifier">TMsgHandler</span> <span class="Other">=</span> <span class="Identifier">stdout_msg_handler</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Wrapper over <a class="reference external" href="#rst_string_to_html">rst_string_to_html</a> to catch exceptions.</p>
<p>Returns always a valid HTML. If something bad happens, it tries to show the error for debugging but still returns valid HTML, though it may be quite different from what you expect. The <cite>filename</cite> parameter is only used for error reporting, you can pass nil or the empty string.</p>
<p>This proc always returns without raising any exceptions, but if you want to know about errors you can pass the address of an initialized sequence of string as the <cite>ERRORS</cite> parameter to figure out why something fails and report it to the user. Any problems found during rendering will be added to the existing list.</p>
<p>The value for the <cite>user_config</cite> parameter is explained in <a class="reference external" href="lazy_rest_pkg/lrstgen.html#initRstGenerator">lazy_rest/lrstgen.initRstGenerator()</a>.</p>
<p>Usage example:</p>
<pre><span class="Identifier">echo</span> <span class="Identifier">safe_rst_string_to_html</span><span class="Punctuation">(</span><span class="Keyword">nil</span><span class="Punctuation">,</span> <span class="Identifier">rst</span><span class="Punctuation">)</span>
<span class="Comment"># --&gt; dumps HTML saying something bad happened.</span>
<span class="Keyword">var</span> <span class="Identifier">ERRORS</span><span class="Punctuation">:</span> <span class="Identifier">seq</span><span class="Punctuation">[</span><span class="Identifier">string</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="Operator">@</span><span class="Punctuation">[</span><span class="Punctuation">]</span>
<span class="Keyword">let</span> <span class="Identifier">html</span> <span class="Operator">=</span> <span class="Identifier">safe_rst_string_to_html</span><span class="Punctuation">(</span><span class="Identifier">name</span><span class="Punctuation">,</span> <span class="Identifier">rst</span><span class="Punctuation">,</span> <span class="Identifier">ERRORS</span><span class="Operator">.</span><span class="Keyword">addr</span><span class="Punctuation">)</span>
<span class="Keyword">if</span> <span class="Identifier">ERRORS</span><span class="Operator">.</span><span class="Identifier">len</span> <span class="Operator">&gt;</span> <span class="DecNumber">0</span><span class="Punctuation">:</span>
  <span class="Comment"># We got HTML, but it it won't be nice.</span>
  <span class="Keyword">for</span> <span class="Identifier">error</span> <span class="Keyword">in</span> <span class="Identifier">ERRORS</span><span class="Punctuation">:</span> <span class="Identifier">echo</span> <span class="Identifier">error</span>
  <span class="Operator">...</span>
<span class="Keyword">else</span><span class="Punctuation">:</span>
  <span class="Comment"># Yay, use `html` without worries.</span></pre>

</dd>
<dt id="safe_rst_file_to_html"><a name="safe_rst_file_to_html,string,ptr.seq[string],PStringTable,Find_file_handler,TMsgHandler"></a><pre><span class="Keyword">proc</span> <span class="Identifier">safe_rst_file_to_html</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">ERRORS</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">;</span> 
                            <span class="Identifier">user_config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">;</span> <span class="Identifier">find_file</span><span class="Other">:</span> <span class="Identifier">Find_file_handler</span> <span class="Other">=</span> <span class="Identifier">unrestricted_find_file_handler</span><span class="Other">;</span> 
                            <span class="Identifier">msg_handler</span><span class="Other">:</span> <span class="Identifier">TMsgHandler</span> <span class="Other">=</span> <span class="Identifier">stdout_msg_handler</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Wrapper over <a class="reference external" href="#rst_file_to_html">rst_file_to_html</a> to catch exceptions.</p>
<p>Returns always a valid HTML. If something bad happens, it tries to show the error for debugging but still returns valid HTML, though it may be quite different from what you expect.</p>
<p>This proc always returns without raising any exceptions, but if you want to know about errors you can pass the address of an initialized sequence of string as the <cite>ERRORS</cite> parameter to figure out why something fails and report it to the user. Any problems found during rendering will be added to the existing list.</p>
<p>The value for the <cite>user_config</cite> parameter is explained in <a class="reference external" href="lazy_rest_pkg/lrstgen.html#initRstGenerator">lazy_rest/lrstgen.initRstGenerator()</a>.</p>
<p>Usage example:</p>
<pre><span class="Keyword">import</span> <span class="Identifier">os</span>

<span class="Identifier">echo</span> <span class="Identifier">safe_rst_file_to_html</span><span class="Punctuation">(</span><span class="Keyword">nil</span><span class="Punctuation">)</span>
<span class="Comment"># --&gt; dumps HTML saying something bad happened.</span>
<span class="Keyword">var</span> <span class="Identifier">ERRORS</span><span class="Punctuation">:</span> <span class="Identifier">seq</span><span class="Punctuation">[</span><span class="Identifier">string</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="Operator">@</span><span class="Punctuation">[</span><span class="Punctuation">]</span>
<span class="Keyword">let</span> <span class="Identifier">html</span> <span class="Operator">=</span> <span class="Identifier">safe_rst_file_to_html</span><span class="Punctuation">(</span><span class="Identifier">filename</span><span class="Punctuation">,</span> <span class="Identifier">ERRORS</span><span class="Operator">.</span><span class="Keyword">addr</span><span class="Punctuation">)</span>
<span class="Keyword">if</span> <span class="Identifier">ERRORS</span><span class="Operator">.</span><span class="Identifier">len</span> <span class="Operator">&gt;</span> <span class="DecNumber">0</span><span class="Punctuation">:</span>
  <span class="Comment"># We got HTML, but it it won't be nice.</span>
  <span class="Keyword">for</span> <span class="Identifier">error</span> <span class="Keyword">in</span> <span class="Identifier">ERRORS</span><span class="Punctuation">:</span> <span class="Identifier">echo</span> <span class="Identifier">error</span>
  <span class="Operator">...</span>
<span class="Keyword">else</span><span class="Punctuation">:</span>
  <span class="Identifier">filename</span><span class="Operator">.</span><span class="Identifier">change_file_ext</span><span class="Punctuation">(</span><span class="StringLit">&quot;html&quot;</span><span class="Punctuation">)</span><span class="Operator">.</span><span class="Identifier">write_file</span><span class="Punctuation">(</span><span class="Identifier">html</span><span class="Punctuation">)</span></pre>

</dd>
<dt id="nim_file_to_html"><a name="nim_file_to_html,string,PStringTable"></a><pre><span class="Keyword">proc</span> <span class="Identifier">nim_file_to_html</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">number_lines</span> <span class="Other">=</span> <span class="Identifier">true</span><span class="Other">;</span> 
                       <span class="Identifier">user_config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Puts the contents of <cite>filename</cite> in a code block to render as rest.</p>
<p>Returns a string with the rendered HTML. The <cite>number_lines</cite> parameter controls if the rendered source will have a column to the left of the source with line numbers. By default source lines will be numbered.</p>
<p>This proc always works, since even empty code blocks should render (as empty HTML), and there should be no content escaping problems. In the case of failure, the error itself will be rendered in the final HTML.</p>


</dd>
<dt id="set_normal_error_rst"><a name="set_normal_error_rst,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">set_normal_error_rst</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">input_rst</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">{.</span><span class="Identifier">discardable</span><span class="Other">,</span> 
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Changes the default error page for <tt class="docutils literal"><span class="pre">safe_*</span></tt> function errors.</p>
<p>Use this proc to customize the look of error HTML generated by procs like <a class="reference external" href="#safe_rst_file_to_html">safe_rst_file_to_html()</a> when they encounter minor errors like parsing problems which can be handled. You need to pass a valid reStructuredText input. Pass <tt class="docutils literal"><span class="pre">nil</span></tt> or the empty string if you want to recover the default embedded template. You might also want to call <a class="reference external" href="#set_safe_error_rst">set_safe_error_rst()</a>.</p>
<p>See the document <a class="reference external" href="docs/error_handling.html">Lazy reST error handling</a> for more information on what your <tt class="docutils literal"><span class="pre">input_rst</span></tt> variable can contain. The only requirement is that it is valid reStructuredText.</p>
<p>Returns an empty string on success or a list of error messages indicating problems with <tt class="docutils literal"><span class="pre">input_rst</span></tt>.</p>


</dd>
<dt id="set_safe_error_rst"><a name="set_safe_error_rst,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">set_safe_error_rst</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">input_rst</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">{.</span><span class="Identifier">discardable</span><span class="Other">,</span> 
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Changes the safe error page for <tt class="docutils literal"><span class="pre">safe_*</span></tt> function errors.</p>
<p>Use this proc to customize the look of error HTML generated by procs like <a class="reference external" href="#safe_rst_file_to_html">safe_rst_file_to_html()</a> when they encounter a fatal error which can't be handled in any way (these should be very rare) and the error HTML has to be concatenated without interpolation. You need to pass a valid reStructuredText input. Pass <tt class="docutils literal"><span class="pre">nil</span></tt> or the empty string if you want to recover the default embedded template. You might also want to call <a class="reference external" href="#set_safe_error_rst">set_safe_error_rst()</a>.</p>
<p>See the document <a class="reference external" href="docs/error_handling.html">Lazy reST error handling</a> for more information on what your <tt class="docutils literal"><span class="pre">input_rst</span></tt> variable needs to contain. Unlike <a class="reference external" href="#set_normal_error_rst">set_normal_error_rst()</a> your <tt class="docutils literal"><span class="pre">input_rst</span></tt> is required to produce a <tt class="docutils literal"><span class="pre">$content</span></tt> string somewhere to be a valid replacement for the embedded default.</p>
<p>Returns an empty string on success or a list of error messages indicating problems with <tt class="docutils literal"><span class="pre">input_rst</span></tt>.</p>


</dd>

</dl></div>

</div>

<small>Generated: 2014-11-28 22:48:08 UTC</small>
</div>
</body>
</html>
