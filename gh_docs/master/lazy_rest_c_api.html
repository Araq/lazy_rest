<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nimrod. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module lazy_rest_c_api</title>
<style type="text/css">

span.DecNumber {color: blue}
span.BinNumber {color: blue}
span.HexNumber {color: blue}
span.OctNumber {color: blue}
span.FloatNumber {color: blue}
span.Identifier  {color: black}
span.Keyword {font-weight: bold}
span.StringLit {color: blue}
span.LongStringLit {color: blue}
span.CharLit {color: blue}
span.EscapeSequence {color: black}
span.Operator {color: black}
span.Punctuation {color: black}
span.Comment, span.LongComment {font-style:italic; color: green}
span.RegularExpression  {color: DarkViolet}
span.TagStart {color: DarkViolet}
span.TagEnd {color: DarkViolet}
span.Key  {color: blue}
span.Value  {color: black}
span.RawData {color: blue}
span.Assembler  {color: blue}
span.Preprocessor {color: DarkViolet}
span.Directive  {color: DarkViolet}
span.Command, span.Rule, span.Hyperlink, span.Label, span.Reference, 
span.Other  {color: black}

div.navigation {
  -moz-border-radius: 5px 5px 5px 5px;
  float: left; 
  width: 30%;
  margin: 0; padding: 0;
  border: 3px outset #7F7F7F;
  background-color: #7F7F7F;
}

div.navigation ul {
  list-style-type: none;
  padding-left: 1em;
}
div.navigation ul li a, div.navigation ul li a:visited {
  font-weight: bold;
  color: #FFFFFF;
  text-decoration: none;
}
div.navigation ul li a:hover {
  font-weight: bold;
  text-decoration: none;
  color: gold;
}

div.content {
  margin-left: 30%;
  padding: 0 1em;
  border-left: 4em;
}

dl.item dd, dl.item dd p {
  margin-top:3px;
}
dl.item dd pre {
  margin-left: 15pt;
  border: 0px;
}
dl.item dt, dl.item dt pre {
  margin:  20pt 0 0 5pt;
}

pre, span.tok {
  background-color: #F9F9F9;
  border-color: #C4C4C4;
  border-style: solid;
  border-width: 1px 1px 1px 2px;
  color: black;
  line-spacing: 110%;
  padding: 2px;
}

span.red {
  color: #A80000;
}

hr {background-color:#9D9D9D; border:0 none; color:#9D9D9D; height:1px; width:100%;}

/*
:Author: David Goodger
:Contact: goodger@python.org
:Date: Date: 2006-05-21 22:44:42 +0200 (Sun, 21 May 2006)
:Revision: Revision: 4564
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/
/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th { border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first { margin-top: 0 ! important }
.last, .with-subtitle { margin-bottom: 0 ! important }
.hidden { display: none }
a.toc-backref { text-decoration: none ; color: black }
blockquote.epigraph { margin: 2em 5em ; }
dl.docutils dd { margin-bottom: 0.5em }
div.abstract { margin: 2em 5em }
div.abstract p.topic-title { font-weight: bold ; text-align: center }
div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ; border: medium outset ; padding: 1em }
div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title { font-weight: bold ; font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title { color: red ; font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication { margin: 2em 5em ; text-align: center ; font-style: italic }
div.dedication p.topic-title { font-weight: bold ; font-style: normal }
div.figure { margin-left: 2em ; margin-right: 2em }
div.footer, div.header { clear: both; font-size: smaller }
div.line-block { display: block ; margin-top: 1em ; margin-bottom: 1em }
div.line-block div.line-block { margin-top: 0 ; margin-bottom: 0 ;
  margin-left: 1.5em }
div.sidebar { margin-left: 1em ; border: medium outset ;
  padding: 1em ; background-color: #ffffee ; /*width: 40% ;*/ float: right ;
  clear: right }

div.sidebar p.rubric { font-family: sans-serif ; font-size: medium }
div.system-messages { margin: 5em }
div.system-messages h1 { color: red }
div.system-message { border: medium outset ; padding: 1em }
div.system-message p.system-message-title { color: red ; font-weight: bold }
div.topic { margin: 2em;}
h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }
h1.title { text-align: center }
h2.subtitle { text-align: center }
/* hr.docutils { width: 75% } */
img.align-left { clear: left }
img.align-right { clear: right }
ol.simple, ul.simple { margin-bottom: 1em }
ol.arabic { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }
p.attribution { text-align: right ; margin-left: 50% }
p.caption { font-style: italic }
p.credits { font-style: italic ; font-size: smaller }
p.label { white-space: nowrap }
p.rubric { font-weight:bold;font-size:larger;color:maroon;text-align:center}
p.sidebar-title {font-family: sans-serif ;font-weight: bold ;font-size: larger }
p.sidebar-subtitle {font-family: sans-serif ; font-weight: bold }
p.topic-title {
font-weight: bold;
background-color: #6D6D6D;
border-bottom: 1px solid #000000;
border-top: 1px solid black;
color: white;
text-align: center;
margin: 0;
}
pre.address { margin-bottom: 0;margin-top:0;font-family:serif;font-size:100% }
pre.literal-block, pre.doctest-block {margin-left: 2em ;margin-right: 2em }
span.classifier {font-family: sans-serif;font-style: oblique }
span.classifier-delimiter {font-family: sans-serif;font-weight: bold }
span.interpreted {font-family: sans-serif }
span.option {white-space: nowrap }
span.pre {white-space: pre }
span.problematic {color: red }
span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation { border-left: solid 1px gray; margin-left: 1px }
table.docinfo {margin: 2em 4em }
table.docutils {margin-top: 0.5em;margin-bottom: 0.5em; border: 0 solid #9d9d9d; border-collapse: collapse; }
table.footnote {border-left: solid 1px black;margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {padding-left: 0.5em;padding-right: 0.5em;
  vertical-align: top;}

table.docutils td, table.docutils th { border-bottom:1px solid #9D9D9D; }
/* color: #4d4d4d} */

/* table.docutils td:hover, table.docinfo td:hover {color: #000000} */
  

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold;text-align: left;white-space: nowrap;padding-left: 0 }
  
table.docutils th
{
color: black;
font-weight:normal;
background-color: #E3E3E3;
border-top: 1px solid #1d1d1d;
border-bottom: 1px solid #1d1d1d;
}
  
h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {font-size: 100% }
ul.auto-toc { list-style-type: none }
/*a.reference { color: #E00000; font-weight:bold;}
a.reference:hover {color: #E00000;background-color: #ffff00;display: margin;
  font-weight:bold;}*/

</style>

</head>
<body>
<div class="document" id="documentId">
<h1 class="title">Module lazy_rest_c_api</h1>
<div class="navigation" id="navigation">
<ul class="simple">
<li>
  <a class="reference" href="#6" id="56">Imports</a>
  <ul class="simple">
    
  </ul>
</li>
<li>
  <a class="reference" href="#7" id="57">Types</a>
  <ul class="simple">
      <li><a class="reference" href="#lr_c_msg_handler"
    title="lr_c_msg_handler* = proc (filename: cstring; line, col: cint; msgkind: char; 
                          arg: cstring): cstring"><wbr />lr_<wbr />c_<wbr />msg_<wbr />handler</a></li>
  <li><a class="reference" href="#lr_c_find_file_handler"
    title="lr_c_find_file_handler* = proc (current_filename, target_filename, out_path: cstring; 
                                max_length: cint)"><wbr />lr_<wbr />c_<wbr />find_<wbr />file_<wbr />handler</a></li>

  </ul>
</li>
<li>
  <a class="reference" href="#12" id="62">Procs</a>
  <ul class="simple">
      <li><a class="reference" href="#lr_version_int,ptr.cint,ptr.cint,ptr.cint"
    title="lr_version_int*(major, minor, maintenance: ptr cint)"><wbr />lr_<wbr />version_<wbr />int</a></li>
  <li><a class="reference" href="#lr_version_str,"
    title="lr_version_str*(): cstring"><wbr />lr_<wbr />version_<wbr />str</a></li>
  <li><a class="reference" href="#lr_parse_rst_options,cstring"
    title="lr_parse_rst_options*(options: cstring): PStringTable"><wbr />lr_<wbr />parse_<wbr />rst_<wbr />options</a></li>
  <li><a class="reference" href="#lr_set_global_rst_options,cstring"
    title="lr_set_global_rst_options*(options: cstring): cint"><wbr />lr_<wbr />set_<wbr />global_<wbr />rst_<wbr />options</a></li>
  <li><a class="reference" href="#lr_set_nim_msg_handler,TMsgHandler"
    title="lr_set_nim_msg_handler*(nim_func: TMsgHandler)"><wbr />lr_<wbr />set_<wbr />nim_<wbr />msg_<wbr />handler</a></li>
  <li><a class="reference" href="#lr_set_c_msg_handler,lr_c_msg_handler"
    title="lr_set_c_msg_handler*(c_func: lr_c_msg_handler)"><wbr />lr_<wbr />set_<wbr />c_<wbr />msg_<wbr />handler</a></li>
  <li><a class="reference" href="#lr_set_nim_find_file_handler,Find_file_handler"
    title="lr_set_nim_find_file_handler*(nim_func: Find_file_handler)"><wbr />lr_<wbr />set_<wbr />nim_<wbr />find_<wbr />file_<wbr />handler</a></li>
  <li><a class="reference" href="#lr_set_c_find_file_handler,lr_c_find_file_handler"
    title="lr_set_c_find_file_handler*(c_func: lr_c_find_file_handler)"><wbr />lr_<wbr />set_<wbr />c_<wbr />find_<wbr />file_<wbr />handler</a></li>
  <li><a class="reference" href="#lr_set_find_file_buffer_size,cint"
    title="lr_set_find_file_buffer_size*(s: cint): cint"><wbr />lr_<wbr />set_<wbr />find_<wbr />file_<wbr />buffer_<wbr />size</a></li>
  <li><a class="reference" href="#lr_rst_string_to_html,cstring,cstring,PStringTable"
    title="lr_rst_string_to_html*(content, filename: cstring; config: PStringTable): cstring"><wbr />lr_<wbr />rst_<wbr />string_<wbr />to_<wbr />html</a></li>
  <li><a class="reference" href="#lr_rst_string_to_html_error,"
    title="lr_rst_string_to_html_error*(): cstring"><wbr />lr_<wbr />rst_<wbr />string_<wbr />to_<wbr />html_<wbr />error</a></li>
  <li><a class="reference" href="#lr_rst_file_to_html,cstring,PStringTable"
    title="lr_rst_file_to_html*(filename: cstring; config: PStringTable): cstring"><wbr />lr_<wbr />rst_<wbr />file_<wbr />to_<wbr />html</a></li>
  <li><a class="reference" href="#lr_rst_file_to_html_error,"
    title="lr_rst_file_to_html_error*(): cstring"><wbr />lr_<wbr />rst_<wbr />file_<wbr />to_<wbr />html_<wbr />error</a></li>
  <li><a class="reference" href="#lr_safe_rst_string_to_html,cstring,cstring,ptr.cint,PStringTable"
    title="lr_safe_rst_string_to_html*(data, filename: cstring; ERRORS: ptr cint; 
                            config: PStringTable): cstring"><wbr />lr_<wbr />safe_<wbr />rst_<wbr />string_<wbr />to_<wbr />html</a></li>
  <li><a class="reference" href="#lr_safe_rst_string_to_html_error,cint"
    title="lr_safe_rst_string_to_html_error*(pos: cint): cstring"><wbr />lr_<wbr />safe_<wbr />rst_<wbr />string_<wbr />to_<wbr />html_<wbr />error</a></li>
  <li><a class="reference" href="#lr_safe_rst_file_to_html,cstring,ptr.cint,PStringTable"
    title="lr_safe_rst_file_to_html*(filename: cstring; ERRORS: ptr cint; 
                          config: PStringTable): cstring"><wbr />lr_<wbr />safe_<wbr />rst_<wbr />file_<wbr />to_<wbr />html</a></li>
  <li><a class="reference" href="#lr_safe_rst_file_to_html_error,cint"
    title="lr_safe_rst_file_to_html_error*(pos: cint): cstring"><wbr />lr_<wbr />safe_<wbr />rst_<wbr />file_<wbr />to_<wbr />html_<wbr />error</a></li>
  <li><a class="reference" href="#lr_source_string_to_html,cstring,cstring,cstring,cint,PStringTable"
    title="lr_source_string_to_html*(content, filename, language: cstring; 
                          number_lines: cint; config: PStringTable): cstring"><wbr />lr_<wbr />source_<wbr />string_<wbr />to_<wbr />html</a></li>
  <li><a class="reference" href="#lr_source_file_to_html,cstring,cstring,cint,PStringTable"
    title="lr_source_file_to_html*(filename: cstring; language: cstring; 
                        number_lines: cint; config: PStringTable): cstring"><wbr />lr_<wbr />source_<wbr />file_<wbr />to_<wbr />html</a></li>
  <li><a class="reference" href="#lr_set_normal_error_rst,cstring,PStringTable"
    title="lr_set_normal_error_rst*(input_rst: cstring; config: PStringTable): cint"><wbr />lr_<wbr />set_<wbr />normal_<wbr />error_<wbr />rst</a></li>
  <li><a class="reference" href="#lr_set_normal_error_rst_error,cint"
    title="lr_set_normal_error_rst_error*(pos: cint): cstring"><wbr />lr_<wbr />set_<wbr />normal_<wbr />error_<wbr />rst_<wbr />error</a></li>
  <li><a class="reference" href="#lr_set_safe_error_rst,cstring,PStringTable"
    title="lr_set_safe_error_rst*(input_rst: cstring; config: PStringTable): cint"><wbr />lr_<wbr />set_<wbr />safe_<wbr />error_<wbr />rst</a></li>
  <li><a class="reference" href="#lr_set_safe_error_rst_error,cint"
    title="lr_set_safe_error_rst_error*(pos: cint): cstring"><wbr />lr_<wbr />set_<wbr />safe_<wbr />error_<wbr />rst_<wbr />error</a></li>

  </ul>
</li>

</ul>
</div>
<div class="content" id="content">
<p>Exported C API of <a class="reference external" href="https://github.com/gradha/lazy_rest">lazy_rest</a> a reStructuredText processing module for Nimrod.</p>
<p>These are simple Nimrod wrappers around the main <a class="reference external" href="lazy_rest.html">lazy_rest.nim</a> module. They just document and export for C the most interesting procs to be consumed by other C programs. Usually you will compile this module using the <a class="reference external" href="http://nimrod-lang.org/backends.html#backend-code-calling-nimrod">--header command line switch</a> which generates the appropriate <tt class="docutils literal"><span class="pre">.c</span></tt> and <tt class="docutils literal"><span class="pre">.h</span></tt> files inside the <a class="reference external" href="http://nimrod-lang.org/backends.html#nimcache-naming-logic">nimcache directory</a>, then compile those into your C program. For more information see the <a class="reference external" href="docs/c_usage.html">C usage guide</a>.</p>
<p>Due to the differences between Nimrod and C, most of the wrapper procs will assign the return values to Nimrod global variables so that their memory is not freed while <em>other</em> Nimrod code executes (potentially triggering garbage collections). This means the C API is not thread safe nor reentrant.  You should also always call these procs from the main thread UI due to the garbage collector not being thread aware either.</p>
<p>When passing <tt class="docutils literal"><span class="pre">cstring</span></tt> types back and forth, consider all of them to be <tt class="docutils literal"><span class="pre">char*</span></tt> strings encoded in UTF8. This means that you are not able to pass embedded <tt class="docutils literal"><span class="pre">NULLs</span></tt> in text since they will be treated as string terminators. In practice this should not be a problem given the nature of text processing.</p>
<p>There is a limitation with regards to passing configuration options from C (see <a class="reference external" href="#lr_parse_rst_options">lr_parse_rst_options()</a>) so the convenience <a class="reference external" href="#lr_set_global_rst_options">lr_set_global_rst_options()</a> is provided instead. The public API will remain having configuration options as parameters for the future though.</p>

<div class="section" id="6">
<h1><a class="toc-backref" href="#56">Imports</a></h1>
<dl class="item">
<a class="reference external" href="lazy_rest.html">lazy_rest</a>, <a class="reference external" href="bb_system.html">bb_system</a>, <a class="reference external" href="strtabs.html">strtabs</a>, <a class="reference external" href="strutils.html">strutils</a>
</dl></div>
<div class="section" id="7">
<h1><a class="toc-backref" href="#57">Types</a></h1>
<dl class="item">
<dt id="lr_c_msg_handler"><a name="lr_c_msg_handler"></a><pre><span class="Identifier">lr_c_msg_handler</span><span class="Operator">*</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">.}</span> <span class="Other">=</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> <span class="Identifier">line</span><span class="Other">,</span> <span class="Identifier">col</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">;</span> 
                                      <span class="Identifier">msgkind</span><span class="Other">:</span> <span class="Identifier">char</span><span class="Other">;</span> <span class="Identifier">arg</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>
Defines a C callback for message handlers.</p>
<p>This callback works exactly the same like <a class="reference external" href="lazy_rest_pkg/lrst.html#TMsgHandler">TMsgHandler</a> but for C code. These callbacks are set globally through the <a class="reference external" href="#lr_set_c_msg_handler">lr_set_c_msg_handler()</a> proc.</p>


</dd>
<dt id="lr_c_find_file_handler"><a name="lr_c_find_file_handler"></a><pre><span class="Identifier">lr_c_find_file_handler</span><span class="Operator">*</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">.}</span> <span class="Other">=</span> <span class="Keyword">proc</span> <span class="Other">(</span>
    <span class="Identifier">current_filename</span><span class="Other">,</span> <span class="Identifier">target_filename</span><span class="Other">,</span> <span class="Identifier">out_path</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> <span class="Identifier">max_length</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">)</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>
Defines a C callback for resolving file paths.</p>
<p>This callback works nearly the same like <a class="reference external" href="lazy_rest_pkg/lrst.html#Find_file_handler">Find_file_handler</a> but for C code. These callbacks are set globally through the <a class="reference external" href="#lr_set_c_find_file_handler">lr_set_c_find_file_handler()</a> proc.</p>
<p>The main difference with regards to the Nimrod version is that the C version doesn't return any string due to memory management issues. The C version should write the result of the file path operation to the pre allocated <cite>out_path</cite>. The length of the buffer <cite>out_path</cite> is passed in as the parameter <cite>max_length</cite>, your string must fit into this size (including its NULL terminator!).</p>
<p>By default <cite>max_length</cite> will be 255, but you can change this value with <a class="reference external" href="#lr_set_find_file_buffer_size">lr_set_find_file_buffer_size</a>. Remember that paths are always UTF-8.</p>


</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#62">Procs</a></h1>
<dl class="item">
<dt id="lr_version_int"><a name="lr_version_int,ptr.cint,ptr.cint,ptr.cint"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_version_int</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">major</span><span class="Other">,</span> <span class="Identifier">minor</span><span class="Other">,</span> <span class="Identifier">maintenance</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">cint</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">cdecl</span><span class="Other">,</span> 
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Wraps <a class="reference external" href="lazy_rest.html#version_int">version_int</a> for C.</p>
<p>Pass pointers to whatever version values you are interested it and they will be filled. Example:</p>
<pre><span class="Keyword">int</span> <span class="Identifier">major</span> <span class="Operator">=</span> <span class="DecNumber">6</span><span class="Punctuation">,</span> <span class="Identifier">minor</span> <span class="Operator">=</span> <span class="DecNumber">6</span><span class="Punctuation">,</span> <span class="Identifier">maintenance</span> <span class="Operator">=</span> <span class="DecNumber">6</span><span class="Punctuation">;</span>
<span class="Identifier">lr_version_int</span><span class="Punctuation">(</span><span class="Operator">&amp;</span><span class="Identifier">major</span><span class="Punctuation">,</span> <span class="Operator">&amp;</span><span class="Identifier">minor</span><span class="Punctuation">,</span> <span class="Operator">&amp;</span><span class="Identifier">maintenance</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;Using lazy_rest: %d-%d-%d.</span><span class="EscapeSequence">\n</span><span class="StringLit">&quot;</span><span class="Punctuation">,</span>
   <span class="Identifier">major</span><span class="Punctuation">,</span> <span class="Identifier">minor</span><span class="Punctuation">,</span> <span class="Identifier">maintenance</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Comment">// --&gt; Using lazy_rest: 0-1-0.</span></pre>

</dd>
<dt id="lr_version_str"><a name="lr_version_str,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_version_str</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Wraps <a class="reference external" href="lazy_rest.html#version_str">version_str</a> for C.</p>
<p>Always returns the same pointer to a valid <tt class="docutils literal"><span class="pre">cstring</span></tt>. Example:</p>
<pre><span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;Using lazy_rest %s.</span><span class="EscapeSequence">\n</span><span class="StringLit">&quot;</span><span class="Punctuation">,</span> <span class="Identifier">lr_version_str</span><span class="Punctuation">(</span><span class="Punctuation">)</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Comment">// --&gt; Using lazy_rest 0.1.0.</span></pre>

</dd>
<dt id="lr_parse_rst_options"><a name="lr_parse_rst_options,cstring"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_parse_rst_options</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">options</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">PStringTable</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Wraps <a class="reference external" href="lazy_rest.html#parse_rst_options">parse_rst_options()</a> for C.</p>
<p>The return value is stored in a global variable so future calls to this function will mangle the returned value. It is unlikely you will need to call this more than once though.</p>
<p>Also, due to a <a class="reference external" href="https://github.com/Araq/Nimrod/issues/1579">limitation</a> in Nimrod's exportc pragma, right now the <tt class="docutils literal"><span class="pre">PStringTable</span></tt> type will be exported to the C header like <tt class="docutils literal"><span class="pre">typedef struct tstringtable128812 tstringtable128812</span></tt>, so it may be difficult or impossible to write crossplatform source code which calls this function, given that each platform's Nimrod compiler (or version) may generate a different symbol. Still, the function is here for completeness (and maybe you don't mind the weird <tt class="docutils literal"><span class="pre">typedef</span></tt>). You can use <a class="reference external" href="#lr_set_global_rst_options">lr_set_global_rst_options()</a> to work around this issue.</p>


</dd>
<dt id="lr_set_global_rst_options"><a name="lr_set_global_rst_options,cstring"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_set_global_rst_options</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">options</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cint</span> <span class="Other">{.</span><span class="Identifier">discardable</span><span class="Other">,</span> <span class="Identifier">exportc</span><span class="Other">,</span> 
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Works around <a class="reference external" href="#lr_parse_rst_options">lr_parse_rst_options()</a> limitations.</p>
<p>Since in C you can't get a hold of the type of a <tt class="docutils literal"><span class="pre">PStringTable</span></tt> conveniently, this will call <a class="reference external" href="#lr_parse_rst_options">lr_parse_rst_options()</a> and store the result in a special global variable. From this moment on, every call to the public API which accepts a <tt class="docutils literal"><span class="pre">PStringTable</span></tt>, if you pass <tt class="docutils literal"><span class="pre">null</span></tt> the global variable stored by this function will be used instead.</p>
<p>At some point in the future this function will disappear (obviously when <tt class="docutils literal"><span class="pre">PStringTable</span></tt> can be exported properly).</p>
<p>Returns zero if <a class="reference external" href="#lr_parse_rst_options">lr_parse_rst_options()</a> returned <tt class="docutils literal"><span class="pre">nil</span></tt>, non zero otherwise.</p>


</dd>
<dt id="lr_set_nim_msg_handler"><a name="lr_set_nim_msg_handler,TMsgHandler"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_set_nim_msg_handler</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">nim_func</span><span class="Other">:</span> <span class="Identifier">TMsgHandler</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Specifies the Nimrod message handler to use for rst processing.</p>
<p>Since the C API doesn't provide explicit callback parameters, you can use this function to specify which of the built in Nimrod callbacks you want to use. The available callbacks are:</p>
<ul class="simple"><li><a class="reference external" href="lazy_rest.html#stdout_msg_handler">lr_stdout_msg_handler</a>.</li>
<li><a class="reference external" href="lazy_rest_pkg/lrst.html#nil_msg_handler">lr_nil_msg_handler</a>.</li>
</ul>
<p>If instead of built in Nimrod procs you would prefer to provide your own C function, use <a class="reference external" href="#lr_set_c_msg_handler">lr_set_c_msg_handler()</a>. Passing <tt class="docutils literal"><span class="pre">NULL</span></tt> to this function is equal to passing <a class="reference external" href="lazy_rest_pkg/lrst.html#nil_msg_handler">lr_nil_msg_handler</a>. Calling this function does <strong>not</strong> override whatever C callback you might have previously set with <a class="reference external" href="#lr_set_c_msg_handler">lr_set_c_msg_handler()</a>, which takes precedence over the Nimrod version.</p>
<p>If you don't call this proc, the default value is <a class="reference external" href="lazy_rest.html#stdout_msg_handler">lr_stdout_msg_handler</a> like in the <a class="reference external" href="lazy_rest.html">Nimrod API</a>.</p>


</dd>
<dt id="lr_set_c_msg_handler"><a name="lr_set_c_msg_handler,lr_c_msg_handler"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_set_c_msg_handler</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">c_func</span><span class="Other">:</span> <span class="Identifier">lr_c_msg_handler</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Specifies the C message handler to use for rst processing.</p>
<p>This is like <a class="reference external" href="#lr_set_nim_msg_handler">lr_set_nim_msg_handler()</a> but allows you to set a custom C callback. Callbacks passed in to this function take precedence over the Nimrod callback. Passing <tt class="docutils literal"><span class="pre">NULL</span></tt> will disable the C callback (which implicitly activates the failsafe Nimrod one).</p>


</dd>
<dt id="lr_set_nim_find_file_handler"><a name="lr_set_nim_find_file_handler,Find_file_handler"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_set_nim_find_file_handler</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">nim_func</span><span class="Other">:</span> <span class="Identifier">Find_file_handler</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Specifies the Nimrod file handler to use for rst processing.</p>
<p>Since the C API doesn't provide explicit callback parameters, you can use this function to specify which of the built in Nimrod callbacks you want to use. The available callbacks are:</p>
<ul class="simple"><li><a class="reference external" href="lazy_rest.html#unrestricted_find_file_handler">lr_unrestricted_find_file_handler()</a>.</li>
<li><a class="reference external" href="lazy_rest_pkg/lrst.html#nil_find_file_handler">lr_nil_find_file_handler()</a>.</li>
</ul>
<p>If instead of built in Nimrod procs you would prefer to provide your own C function, use <a class="reference external" href="#lr_set_c_find_file_handler">lr_set_c_find_file_handler()</a>. Passing <tt class="docutils literal"><span class="pre">NULL</span></tt> to this function is equal to passing <a class="reference external" href="lazy_rest_pkg/lrst.html#nil_find_file_handler">lr_nil_find_file_handler</a>. Calling this function does <strong>not</strong> override whatever C callback you might have previously set with <a class="reference external" href="#lr_set_c_find_file_handler">lr_set_c_find_file_handler()</a>, which take precedence over the Nimrod version.</p>
<p>If you don't call this proc, the default value is <a class="reference external" href="lazy_rest.html#unrestricted_find_file_handler">lr_unrestricted_find_file_handler()</a> like in the <a class="reference external" href="lazy_rest.html">Nimrod API</a>.</p>


</dd>
<dt id="lr_set_c_find_file_handler"><a name="lr_set_c_find_file_handler,lr_c_find_file_handler"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_set_c_find_file_handler</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">c_func</span><span class="Other">:</span> <span class="Identifier">lr_c_find_file_handler</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Specifies the C file handler to use for rst processing.</p>
<p>This is like <a class="reference external" href="#lr_set_nim_find_file_handler">lr_set_nim_find_file_handler()</a> but allows you to set a custom C callback. Callbacks passed in to this function take precedence over the Nimrod callback. Passing <tt class="docutils literal"><span class="pre">NULL</span></tt> will disable the C callback (which implicitly activates the failsafe Nimrod one).</p>


</dd>
<dt id="lr_set_find_file_buffer_size"><a name="lr_set_find_file_buffer_size,cint"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_set_find_file_buffer_size</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cint</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Sets and returns the size for future find file handler buffer sizes.</p>
<p>The size of the output buffer for <a class="reference external" href="#lr_c_find_file_handler">lr_c_find_file_handler()</a> callback functions can be changed by this function. If you pass a negative value <strong>or</strong> a value which is too small (less than 255), the current value won't change. You can use this feature (passing a negative value) to query the current value.</p>
<p>What this means is that you can set buffer sizes equal or greater than 255, but never smaller.</p>


</dd>
<dt id="lr_rst_string_to_html"><a name="lr_rst_string_to_html,cstring,cstring,PStringTable"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_rst_string_to_html</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">content</span><span class="Other">,</span> <span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> <span class="Identifier">config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span>
    <span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Wraps <a class="reference external" href="lazy_rest.html#rst_string_to_html">rst_string_to_html()</a> for C.</p>
<p>Returns a <tt class="docutils literal"><span class="pre">cstring</span></tt> with HTML or a <tt class="docutils literal"><span class="pre">null</span></tt> pointer if there were errors.  In case of errors you can call <a class="reference external" href="#lr_rst_string_to_html_error">lr_rst_string_to_html_error()</a> to retrieve the description, which will be the text of the Nimrod exception.</p>
<p>The memory of the returned <tt class="docutils literal"><span class="pre">cstring</span></tt> will be kept until the next call to this function, you may need to copy it somewhere. Example:</p>
<pre><span class="Keyword">char</span> <span class="Operator">*</span><span class="Identifier">s</span> <span class="Operator">=</span> <span class="Identifier">lr_rst_string_to_html</span><span class="Punctuation">(</span><span class="Identifier">valid_rst_string</span><span class="Punctuation">,</span>
   <span class="StringLit">&quot;&lt;string&gt;&quot;</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Keyword">if</span> <span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
   <span class="Comment">// Success!</span>
<span class="Punctuation">}</span> <span class="Keyword">else</span> <span class="Punctuation">{</span>
   <span class="Comment">// Handle error.</span>
<span class="Punctuation">}</span></pre>

</dd>
<dt id="lr_rst_string_to_html_error"><a name="lr_rst_string_to_html_error,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_rst_string_to_html_error</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Returns the error string for <a class="reference external" href="#lr_rst_string_to_html">lr_rst_string_to_html()</a>.</p>
<p>If a previous call to <a class="reference external" href="#lr_rst_string_to_html">lr_rst_string_to_html()</a> returned <tt class="docutils literal"><span class="pre">null</span></tt> you can call this function to retrieve a textual reason for the failure.</p>
<p>Returns the error string or <tt class="docutils literal"><span class="pre">null</span></tt> if there was no previous error. You may need to copy the returned error string, since its memory could be freed by the next call to <a class="reference external" href="#lr_rst_string_to_html">lr_rst_string_to_html()</a>. Example:</p>
<pre><span class="Keyword">char</span> <span class="Operator">*</span><span class="Identifier">s</span> <span class="Operator">=</span> <span class="Identifier">lr_rst_string_to_html</span><span class="Punctuation">(</span><span class="Identifier">bad_rst_string</span><span class="Punctuation">,</span>
   <span class="StringLit">&quot;&lt;string&gt;&quot;</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Keyword">if</span> <span class="Punctuation">(</span><span class="Operator">!</span><span class="Identifier">s</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
   <span class="Comment">// Handle error.</span>
   <span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;Error processing string: %s</span><span class="EscapeSequence">\n</span><span class="StringLit">&quot;</span><span class="Punctuation">,</span>
      <span class="Identifier">lr_rst_string_to_html_error</span><span class="Punctuation">(</span><span class="Punctuation">)</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Punctuation">}</span></pre>

</dd>
<dt id="lr_rst_file_to_html"><a name="lr_rst_file_to_html,cstring,PStringTable"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_rst_file_to_html</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> <span class="Identifier">config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span>
    <span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Wraps <a class="reference external" href="lazy_rest.html#rst_file_to_html">rst_file_to_html()</a> for C.</p>
<p>Returns a <tt class="docutils literal"><span class="pre">cstring</span></tt> with HTML or a <tt class="docutils literal"><span class="pre">null</span></tt> pointer if there were errors.  In case of errors you can call <a class="reference external" href="#lr_rst_file_to_html_error">lr_rst_file_to_html_error()</a> to retrieve the description, which will be the text of the Nimrod exception.</p>
<p>The memory of the returned <tt class="docutils literal"><span class="pre">cstring</span></tt> will be kept until the next call to this function, you may need to copy it somewhere. Example:</p>
<pre><span class="Keyword">char</span> <span class="Operator">*</span><span class="Identifier">s</span> <span class="Operator">=</span> <span class="Identifier">lr_rst_file_to_html</span><span class="Punctuation">(</span><span class="Identifier">valid_rst_filename</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Keyword">if</span> <span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
   <span class="Comment">// Success!</span>
<span class="Punctuation">}</span> <span class="Keyword">else</span> <span class="Punctuation">{</span>
   <span class="Comment">// Handle error.</span>
<span class="Punctuation">}</span></pre>

</dd>
<dt id="lr_rst_file_to_html_error"><a name="lr_rst_file_to_html_error,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_rst_file_to_html_error</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Returns the error string for <a class="reference external" href="#lr_rst_file_to_html">lr_rst_file_to_html()</a>.</p>
<p>If a previous call to <a class="reference external" href="#lr_rst_file_to_html">lr_rst_file_to_html()</a> returned <tt class="docutils literal"><span class="pre">null</span></tt> you can call this function to retrieve a textual reason for the failure.</p>
<p>Returns the error string or <tt class="docutils literal"><span class="pre">null</span></tt> if there was no previous error. You may need to copy the returned error string, since its memory could be freed by the next call to <a class="reference external" href="#lr_rst_file_to_html">lr_rst_file_to_html()</a>. Example:</p>
<pre><span class="Keyword">char</span> <span class="Operator">*</span><span class="Identifier">s</span> <span class="Operator">=</span> <span class="Identifier">lr_rst_file_to_html</span><span class="Punctuation">(</span><span class="Identifier">bad_rst_filename</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Keyword">if</span> <span class="Punctuation">(</span><span class="Operator">!</span><span class="Identifier">s</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
   <span class="Comment">// Handle error.</span>
   <span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;Error processing file: %s</span><span class="EscapeSequence">\n</span><span class="StringLit">&quot;</span><span class="Punctuation">,</span>
      <span class="Identifier">lr_rst_file_to_html_error</span><span class="Punctuation">(</span><span class="Punctuation">)</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Punctuation">}</span></pre>

</dd>
<dt id="lr_safe_rst_string_to_html"><a name="lr_safe_rst_string_to_html,cstring,cstring,ptr.cint,PStringTable"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_safe_rst_string_to_html</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">data</span><span class="Other">,</span> <span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> <span class="Identifier">ERRORS</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">cint</span><span class="Other">;</span> 
                                 <span class="Identifier">config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">,</span> 
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Wraps <a class="reference external" href="lazy_rest.html#safe_rst_string_to_html">safe_rst_string_to_html()</a> for C.</p>
<p>Returns always a valid <tt class="docutils literal"><span class="pre">cstring</span></tt> with HTML. The memory of the returned <tt class="docutils literal"><span class="pre">cstring</span></tt> will be kept until the next call to this function, you may need to copy it somewhere.</p>
<p>If <cite>ERRORS</cite> is not <tt class="docutils literal"><span class="pre">null</span></tt>, it will store the number of errors found during the processing of the file. If this number is greater than zero, you can use <a class="reference external" href="#lr_safe_rst_string_to_html_error">lr_safe_rst_string_to_html_error()</a> to retrieve their text. Example:</p>
<pre><span class="Keyword">char</span> <span class="Operator">*</span><span class="Identifier">s</span> <span class="Operator">=</span> <span class="Identifier">lr_safe_rst_string_to_html</span><span class="Punctuation">(</span>
   <span class="Identifier">valid_rst_string</span><span class="Punctuation">,</span> <span class="StringLit">&quot;&lt;filename&gt;&quot;</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Identifier">assert</span><span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Comment">// Do here something with `s`.</span></pre>

</dd>
<dt id="lr_safe_rst_string_to_html_error"><a name="lr_safe_rst_string_to_html_error,cint"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_safe_rst_string_to_html_error</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">pos</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Returns error strings for <a class="reference external" href="#lr_safe_rst_string_to_html">lr_safe_rst_string_to_html()</a>.</p>
<p>If a previous call to <a class="reference external" href="#lr_safe_rst_string_to_html">lr_safe_rst_string_to_html()</a> produced errors and you captured them through the <cite>ERRORS</cite> parameter, you can call this function in a loop up to the returned value -1 to figure out the reasons.</p>
<p>Returns the string for the specified error position or null if there was any error (eg. <cite>pos</cite> is an invalid index). You may need to copy the returned error string, since its memory could be freed by the next call to <a class="reference external" href="#lr_safe_rst_string_to_html">lr_safe_rst_string_to_html()</a>. Example:</p>
<pre><span class="Keyword">int</span> <span class="Identifier">errors</span> <span class="Operator">=</span> <span class="DecNumber">666</span><span class="Punctuation">;</span>
<span class="Keyword">char</span> <span class="Operator">*</span><span class="Identifier">s</span> <span class="Operator">=</span> <span class="Identifier">lr_safe_rst_string_to_html</span><span class="Punctuation">(</span>
   <span class="StringLit">&quot;&lt;filename&gt;&quot;</span><span class="Punctuation">,</span> <span class="Identifier">bad_rst_string</span><span class="Punctuation">,</span> <span class="Operator">&amp;</span><span class="Identifier">errors</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Identifier">assert</span><span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Keyword">if</span> <span class="Punctuation">(</span><span class="Identifier">errors</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
   <span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;RST error stack trace:</span><span class="EscapeSequence">\n</span><span class="StringLit">&quot;</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
   <span class="Keyword">while</span> <span class="Punctuation">(</span><span class="Identifier">errors</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
      <span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;</span><span class="EscapeSequence">\t</span><span class="EscapeSequence">%s\n</span><span class="StringLit">&quot;</span><span class="Punctuation">,</span>
         <span class="Identifier">lr_safe_rst_string_to_html_error</span><span class="Punctuation">(</span><span class="Operator">--</span><span class="Identifier">errors</span><span class="Punctuation">)</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
   <span class="Punctuation">}</span>
<span class="Punctuation">}</span>
<span class="Comment">// Still, do here something with `s`.</span></pre>

</dd>
<dt id="lr_safe_rst_file_to_html"><a name="lr_safe_rst_file_to_html,cstring,ptr.cint,PStringTable"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_safe_rst_file_to_html</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> <span class="Identifier">ERRORS</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">cint</span><span class="Other">;</span> 
                               <span class="Identifier">config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">,</span> 
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Wraps <a class="reference external" href="lazy_rest.html#safe_rst_file_to_html">safe_rst_file_to_html()</a> for C.</p>
<p>Returns always a valid <tt class="docutils literal"><span class="pre">cstring</span></tt> with HTML. The memory of the returned <tt class="docutils literal"><span class="pre">cstring</span></tt> will be kept until the next call to this function, you may need to copy it somewhere.</p>
<p>If <cite>ERRORS</cite> is not <tt class="docutils literal"><span class="pre">null</span></tt>, it will store the number of errors found during the processing of the file. If this number is greater than zero, you can use <a class="reference external" href="#lr_safe_rst_file_to_html_error">lr_safe_rst_file_to_html_error()</a> to retrieve their text. Example:</p>
<pre><span class="Keyword">char</span> <span class="Operator">*</span><span class="Identifier">s</span> <span class="Operator">=</span> <span class="Identifier">lr_safe_rst_file_to_html</span><span class="Punctuation">(</span>
   <span class="Identifier">valid_rst_filename</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Identifier">assert</span><span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Comment">// Do here something with `s`.</span></pre>

</dd>
<dt id="lr_safe_rst_file_to_html_error"><a name="lr_safe_rst_file_to_html_error,cint"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_safe_rst_file_to_html_error</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">pos</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Returns error strings for <a class="reference external" href="#lr_safe_rst_file_to_html">lr_safe_rst_file_to_html()</a>.</p>
<p>If a previous call to <a class="reference external" href="#lr_safe_rst_file_to_html">lr_safe_rst_file_to_html()</a> produced errors and you captured them through the <cite>ERRORS</cite> parameter, you can call this function in a loop up to the returned value -1 to figure out the reasons.</p>
<p>Returns the string for the specified error position or null if there was any error (eg. <cite>pos</cite> is an invalid index). You may need to copy the returned error string, since its memory could be freed by the next call to <a class="reference external" href="#lr_safe_rst_file_to_html">lr_safe_rst_file_to_html()</a>. Example:</p>
<pre><span class="Keyword">int</span> <span class="Identifier">errors</span> <span class="Operator">=</span> <span class="DecNumber">666</span><span class="Punctuation">;</span>
<span class="Keyword">char</span> <span class="Operator">*</span><span class="Identifier">s</span> <span class="Operator">=</span> <span class="Identifier">lr_safe_rst_file_to_html</span><span class="Punctuation">(</span>
   <span class="Identifier">bad_rst_filename</span><span class="Punctuation">,</span> <span class="Operator">&amp;</span><span class="Identifier">errors</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Identifier">assert</span><span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Keyword">if</span> <span class="Punctuation">(</span><span class="Identifier">errors</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
   <span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;RST error stack trace:</span><span class="EscapeSequence">\n</span><span class="StringLit">&quot;</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
   <span class="Keyword">while</span> <span class="Punctuation">(</span><span class="Identifier">errors</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
      <span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;</span><span class="EscapeSequence">\t</span><span class="EscapeSequence">%s\n</span><span class="StringLit">&quot;</span><span class="Punctuation">,</span>
         <span class="Identifier">lr_safe_rst_string_to_html_error</span><span class="Punctuation">(</span><span class="Operator">--</span><span class="Identifier">errors</span><span class="Punctuation">)</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
   <span class="Punctuation">}</span>
<span class="Punctuation">}</span>
<span class="Comment">// Still, do here something with `s`.</span></pre>

</dd>
<dt id="lr_source_string_to_html"><a name="lr_source_string_to_html,cstring,cstring,cstring,cint,PStringTable"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_source_string_to_html</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">content</span><span class="Other">,</span> <span class="Identifier">filename</span><span class="Other">,</span> <span class="Identifier">language</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> 
                               <span class="Identifier">number_lines</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">;</span> <span class="Identifier">config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span>
    <span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Wraps <a class="reference external" href="lazy_rest.html#source_string_to_html">source_string_to_html()</a> for C.</p>
<p>The Nimrod boolean parameter is replaced by an <tt class="docutils literal"><span class="pre">int</span></tt> (non zero == <tt class="docutils literal"><span class="pre">true</span></tt>). The memory of the returned <tt class="docutils literal"><span class="pre">cstring</span></tt> will be kept until the next call to this function, you may need to copy it somewhere. Example:</p>
<pre><span class="Keyword">char</span> <span class="Operator">*</span><span class="Identifier">s</span> <span class="Operator">=</span> <span class="Identifier">lr_source_string_to_html</span><span class="Punctuation">(</span><span class="Identifier">buf</span><span class="Punctuation">,</span> <span class="StringLit">&quot;file.nim&quot;</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Comment">// Do here something useful with `s`.</span></pre>

</dd>
<dt id="lr_source_file_to_html"><a name="lr_source_file_to_html,cstring,cstring,cint,PStringTable"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_source_file_to_html</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> <span class="Identifier">language</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> 
                             <span class="Identifier">number_lines</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">;</span> <span class="Identifier">config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span>
    <span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Wraps <a class="reference external" href="lazy_rest.html#source_file_to_html">source_file_to_html()</a> for C.</p>
<p>The Nimrod boolean parameter is replaced by an <tt class="docutils literal"><span class="pre">int</span></tt> (non zero == <tt class="docutils literal"><span class="pre">true</span></tt>). The memory of the returned <tt class="docutils literal"><span class="pre">cstring</span></tt> will be kept until the next call to this function, you may need to copy it somewhere. Example:</p>
<pre><span class="Keyword">char</span> <span class="Operator">*</span><span class="Identifier">s</span> <span class="Operator">=</span> <span class="Identifier">lr_source_file_to_html</span><span class="Punctuation">(</span><span class="StringLit">&quot;file.nim&quot;</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">0</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Comment">// Do here something useful with `s`.</span></pre>

</dd>
<dt id="lr_set_normal_error_rst"><a name="lr_set_normal_error_rst,cstring,PStringTable"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_set_normal_error_rst</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">input_rst</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> <span class="Identifier">config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cint</span> <span class="Other">{.</span>
    <span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Exports <a class="reference external" href="lazy_rest.html#set_normal_error_rst">set_normal_error_rst()</a> for C.</p>
<p>The C API returns the number of errors instead of the list of error messages. If you got a zero, this means success. Otherwise you can use <a class="reference external" href="#lr_set_normal_error_rst_error">lr_set_normal_error_rst_error()</a> in a loop to retrieve the individual error messages. Example:</p>
<pre><span class="Identifier">lr_set_normal_error_rst</span><span class="Punctuation">(</span><span class="Identifier">normal_error_rst</span><span class="Punctuation">)</span><span class="Punctuation">;</span></pre>

</dd>
<dt id="lr_set_normal_error_rst_error"><a name="lr_set_normal_error_rst_error,cint"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_set_normal_error_rst_error</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">pos</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Returns error strings for <a class="reference external" href="#lr_set_normal_error_rst">lr_set_normal_error_rst()</a>.</p>
<p>If a previous call to <a class="reference external" href="#lr_set_normal_error_rst">lr_set_normal_error_rst()</a> did return non zero, you can call this function in a loop up to the returned value -1 to figure out the reasons.</p>
<p>Returns the string for the specified error position or null if there was any error (eg. <cite>pos</cite> is an invalid index). You may need to copy the returned error string, since its memory could be freed by the next call to <a class="reference external" href="#lr_set_normal_error_rst">lr_set_normal_error_rst()</a>. Example:</p>
<pre><span class="Keyword">int</span> <span class="Identifier">errors</span> <span class="Operator">=</span> <span class="Identifier">lr_set_normal_error_rst</span><span class="Punctuation">(</span><span class="Identifier">bad_rst_string</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Keyword">if</span> <span class="Punctuation">(</span><span class="Identifier">errors</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
   <span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;Could not set normal error rst!</span><span class="EscapeSequence">\n</span><span class="StringLit">&quot;</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
   <span class="Keyword">while</span> <span class="Punctuation">(</span><span class="Identifier">errors</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
      <span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;</span><span class="EscapeSequence">\t</span><span class="EscapeSequence">%s\n</span><span class="StringLit">&quot;</span><span class="Punctuation">,</span>
         <span class="Identifier">lr_set_normal_error_rst_error</span><span class="Punctuation">(</span><span class="Operator">--</span><span class="Identifier">errors</span><span class="Punctuation">)</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
   <span class="Punctuation">}</span>
<span class="Punctuation">}</span></pre>

</dd>
<dt id="lr_set_safe_error_rst"><a name="lr_set_safe_error_rst,cstring,PStringTable"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_set_safe_error_rst</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">input_rst</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> <span class="Identifier">config</span><span class="Other">:</span> <span class="Identifier">PStringTable</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cint</span> <span class="Other">{.</span>
    <span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Exports <a class="reference external" href="lazy_rest.html#set_safe_error_rst">set_safe_error_rst()</a> for C.</p>
<p>The C API returns the number of errors instead of the list of error messages. If you got a zero, this means success. Otherwise you can use <a class="reference external" href="#lr_set_safe_error_rst_error">lr_set_safe_error_rst_error()</a> in a loop to retrieve the individual error messages. Example:</p>
<pre><span class="Identifier">lr_set_safe_error_rst</span><span class="Punctuation">(</span><span class="Identifier">safe_error_rst</span><span class="Punctuation">)</span><span class="Punctuation">;</span></pre>

</dd>
<dt id="lr_set_safe_error_rst_error"><a name="lr_set_safe_error_rst_error,cint"></a><pre><span class="Keyword">proc</span> <span class="Identifier">lr_set_safe_error_rst_error</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">pos</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span class="Other">{.</span><span class="Identifier">exportc</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Returns error strings for <a class="reference external" href="#lr_set_safe_error_rst">lr_set_safe_error_rst()</a>.</p>
<p>If a previous call to <a class="reference external" href="#lr_set_safe_error_rst">lr_set_safe_error_rst()</a> did return non zero, you can call this function in a loop up to the returned value -1 to figure out the reasons.</p>
<p>Returns the string for the specified error position or null if there was any error (eg. <cite>pos</cite> is an invalid index). You may need to copy the returned error string, since its memory could be freed by the next call to <a class="reference external" href="#lr_set_safe_error_rst">lr_set_safe_error_rst()</a>. Example:</p>
<pre><span class="Keyword">int</span> <span class="Identifier">errors</span> <span class="Operator">=</span> <span class="Identifier">lr_set_safe_error_rst</span><span class="Punctuation">(</span><span class="Identifier">bad_rst_string</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
<span class="Keyword">if</span> <span class="Punctuation">(</span><span class="Identifier">errors</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
   <span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;Could not set safe error rst!</span><span class="EscapeSequence">\n</span><span class="StringLit">&quot;</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
   <span class="Keyword">while</span> <span class="Punctuation">(</span><span class="Identifier">errors</span><span class="Punctuation">)</span> <span class="Punctuation">{</span>
      <span class="Identifier">printf</span><span class="Punctuation">(</span><span class="StringLit">&quot;</span><span class="EscapeSequence">\t</span><span class="EscapeSequence">%s\n</span><span class="StringLit">&quot;</span><span class="Punctuation">,</span>
         <span class="Identifier">lr_set_safe_error_rst_error</span><span class="Punctuation">(</span><span class="Operator">--</span><span class="Identifier">errors</span><span class="Punctuation">)</span><span class="Punctuation">)</span><span class="Punctuation">;</span>
   <span class="Punctuation">}</span>
<span class="Punctuation">}</span></pre>

</dd>

</dl></div>

</div>

<small>Generated: 2015-01-17 19:56:32 UTC</small>
</div>
</body>
</html>
